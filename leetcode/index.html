<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Leetcode Notes</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="/home/hebi/git/homepage/assets/org.css" /><link rel="stylesheet" type="text/css" href="/home/hebi/git/homepage/assets/hebi.css" /><link rel="stylesheet" type="text/css" href="/assets/org.css" /><link rel="stylesheet" type="text/css" href="/assets/hebi.css" />
<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.cacheClassElem = elem.className;
         elem.cacheClassTarget = target.className;
         target.className = "code-highlighted";
         elem.className   = "code-highlighted";
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(elem.cacheClassElem)
         elem.className = elem.cacheClassElem;
       if(elem.cacheClassTarget)
         target.className = elem.cacheClassTarget;
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href=""> UP </a>
 |
 <a accesskey="H" href="/"> HOME </a>
</div><div id="content">
<h1 class="title">Leetcode Notes</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgbda5727">1. random tricks</a>
<ul>
<li><a href="#org2cac11a">1.1. string functions</a></li>
</ul>
</li>
<li><a href="#orgc0115d2">2. <span class="priority">[A]</span> approaches</a>
<ul>
<li><a href="#org060252a">2.1. <span class="todo TODO">TODO</span> dynamic programming</a>
<ul>
<li><a href="#org50f212b">2.1.1. (extra-state DP)</a></li>
<li><a href="#orgb0863e6">2.1.2. complement's DP</a></li>
<li><a href="#org9be45f8">2.1.3. complement's DP</a></li>
<li><a href="#org2de656c">2.1.4. Palindromic</a></li>
<li><a href="#org30dc6b0">2.1.5. nested DP</a></li>
<li><a href="#orga68e184">2.1.6. FROM take 1 TO how many to take</a></li>
<li><a href="#orgd38503d">2.1.7. Other (easy) DP problems</a>
<ul>
<li><a href="#org0c34516">2.1.7.1. (5391) build-array-where-you-can-find-the-maximum-exactly-k-comparisons</a></li>
<li><a href="#orga8a35d9">2.1.7.2. (920) number of playlists</a></li>
<li><a href="#org6edc7e1">2.1.7.3. 1386. Cinema Seat Allocation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgae700d5">2.2. <span class="todo TODO">TODO</span> recursion</a></li>
<li><a href="#orgbd81d0d">2.3. <span class="todo TODO">TODO</span> divide and conquer</a></li>
</ul>
</li>
<li><a href="#orga03861a">3. <span class="priority">[A]</span> special problems</a>
<ul>
<li><a href="#org776496a">3.1. Number theory</a>
<ul>
<li><a href="#orgf7f9c0e">3.1.1. 1363. Largest Multiple of Three</a></li>
</ul>
</li>
<li><a href="#org2d42705">3.2. <span class="todo TODO">TODO</span> <span class="priority">[A]</span> bit manipulation</a></li>
<li><a href="#org44f846a">3.3. <span class="todo TODO">TODO</span> union find (29)</a></li>
<li><a href="#org075ff85">3.4. <span class="todo TODO">TODO</span> two pointers</a></li>
<li><a href="#orge7ea90c">3.5. <span class="todo TODO">TODO</span> sliding window</a></li>
</ul>
</li>
<li><a href="#org12fa56e">4. data structures</a>
<ul>
<li><a href="#orgb46ef8d">4.1. linear</a>
<ul>
<li><a href="#org63967ac">4.1.1. stack</a></li>
<li><a href="#org36795bf">4.1.2. linked list</a></li>
<li><a href="#org2554f61">4.1.3. queue</a></li>
</ul>
</li>
<li><a href="#orge231ce5">4.2. hash table</a>
<ul>
<li><a href="#org79a30a1">4.2.1. ordered map</a></li>
</ul>
</li>
<li><a href="#org5baadec">4.3. <span class="todo TODO">TODO</span> <span class="priority">[A]</span> tree</a>
<ul>
<li>
<ul>
<li><a href="#orgf42d0a4">4.3.0.1. balanced binary search tree</a></li>
<li><a href="#org91e8bd8">4.3.0.2. 1361. Validate Binary Tree Nodes</a></li>
</ul>
</li>
<li><a href="#orgbaad74e">4.3.1. trie</a></li>
<li><a href="#org935a920">4.3.2. heap</a></li>
<li><a href="#orgaee87b5">4.3.3. segment tree</a></li>
</ul>
</li>
<li><a href="#org05c7dd1">4.4. <span class="todo TODO">TODO</span> <span class="priority">[A]</span> graph</a></li>
</ul>
</li>
<li><a href="#orgda10384">5. Tricky problems</a>
<ul>
<li><a href="#org362e517">5.1. 466. Count The Repetitions (ultra large but repetitive subsequence finding)</a></li>
<li><a href="#orgdc8f64d">5.2. 1366. Rank Teams by Votes</a></li>
<li><a href="#org7a0ae4c">5.3. 1371. Find the Longest Substring Containing Vowels in Even Counts</a></li>
<li><a href="#orgd551e52">5.4. 5359. Maximum Performance of a Team</a></li>
<li><a href="#orgfb5f1f2">5.5. 1392. Longest Happy Prefix</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgbda5727" class="outline-2">
<h2 id="orgbda5727"><span class="section-number-2">1</span> random tricks</h2>
<div class="outline-text-2" id="text-1">
<p>
integer to binary string: <code>bin(324)</code>
</p>

<p>
sort with multiple keys:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-builtin">sorted</span>([0,1,2,3,4,5,6,7,8], key=<span class="org-keyword">lambda</span> x: (x%3, x))
</pre>
</div>

<ul class="org-ul">
<li>ord</li>
<li>chr</li>
</ul>

<p>
<code>@lru_cache</code> decorator can be used for implementing DP, but looks like I have
to  use it carefully to always increase the argument:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> functools <span class="org-keyword">import</span> lru_cache

<span class="org-type">@lru_cache</span>(maxsize=<span class="org-constant">None</span>)
<span class="org-keyword">def</span> <span class="org-function-name">fibonacci_recursive</span>(n):
</pre>
</div>

<p>
9//2 is same as math.floor(9/2)
</p>


<ul class="org-ul">
<li>indices = np.argsort(nums)</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span class="org-builtin">sorted</span>(<span class="org-builtin">range</span>(n), key=cmp_to_key(<span class="org-keyword">lambda</span> x,y: x-y))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">c</span> = Counter(lst)
c[<span class="org-string">'key'</span>]
</pre>
</div>
</div>

<div id="outline-container-org2cac11a" class="outline-3">
<h3 id="org2cac11a"><span class="section-number-3">1.1</span> string functions</h3>
<div class="outline-text-3" id="text-1-1">
<div class="org-src-container">
<pre class="src src-python"><span class="org-doc">'hello'</span>.count(<span class="org-doc">'l'</span>)
<span class="org-doc">'hello'</span>.index(<span class="org-doc">'e'</span>)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orgc0115d2" class="outline-2">
<h2 id="orgc0115d2"><span class="section-number-2">2</span> <span class="priority">[A]</span> approaches</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org060252a" class="outline-3">
<h3 id="org060252a"><span class="section-number-3">2.1</span> <span class="todo TODO">TODO</span> <a href="https://leetcode.com/tag/dynamic-programming/">dynamic programming</a></h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-org50f212b" class="outline-4">
<h4 id="org50f212b"><span class="section-number-4">2.1.1</span> (extra-state DP)</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
<a href="https://leetcode.com/problems/remove-boxes/">546 remove-boxes</a>
</p>

<p>
This is very good problem. This extends simple DP with
</p>
<ol class="org-ol">
<li>two dp variables, i and j</li>
<li>one more state variable k</li>
</ol>

<p>
Reference: <a href="https://leetcode.com/problems/remove-boxes/discuss/101310/Java-top-down-and-bottom-up-DP-solutions">A good post</a>.
</p>

<p>
See the following graph:
</p>


<div class="figure">
<p><img src="./assets/a.png" alt="a.png" style="max-width:100%" />
</p>
</div>

<p>
The first case, directly consume the left <code>k+l</code> a's, and DP on the rest:
</p>

<p>
\[T_l(i,j,k) = T(i+l,j,0) + (k+l)^2\]
</p>

<p>
For each m, consume <code>[i+l:m-1]</code>, and DP on rest:
</p>

<p>
\[T_m(i,j,k) = T(i+l,m-1,0) + T(m,j,k+l)\]
</p>

<p>
The l is computed by:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">def</span> <span class="org-function-name">get_l</span>(i, j):
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">l</span> = 1
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">while</span> l &lt;= j-i <span class="org-keyword">and</span> boxes[i+l] == boxes[i]:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">l</span> += 1
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> l
</pre>
</div>

<p>
The list of m is computed by:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">def</span> <span class="org-function-name">get_ms</span>(i, j, l):
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = []
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> m <span class="org-keyword">in</span> <span class="org-builtin">range</span>(i+l,j+1):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> boxes[m] == boxes[i]:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   res.append(m)
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> res
</pre>
</div>

<p>
The full DP logic:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">n</span> = <span class="org-builtin">len</span>(boxes)
<span class="org-variable-name">mem</span> = np.zeros((n,n,n), <span class="org-builtin">int</span>)
<span class="org-keyword">def</span> <span class="org-function-name">dp</span>(i, j, k):
<span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">the max point of T[i:j]</span>
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> i &gt; j: <span class="org-keyword">return</span> 0
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> i == j: <span class="org-keyword">return</span> (k+1)*(k+1)
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> mem[i,j,k] &gt; 0: <span class="org-keyword">return</span> mem[i,j,k]

<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">l</span> = get_l(i, j)
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = dp(i+l, j, 0) + (k+l) ** 2

<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">ms</span> = get_ms(i, j, l)
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> m <span class="org-keyword">in</span> ms:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">cand</span> = dp(i+l,m-1,0) + dp(m,j,k+l)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> cand &gt; res: <span class="org-variable-name">res</span> = cand

<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mem</span>[i,j,k] = res
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> res
<span class="org-comment-delimiter"># </span><span class="org-comment">the final output:</span>
dp(0, n-1, 0)
</pre>
</div>

<p>
Some tests:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">def</span> <span class="org-function-name">test</span>():
<span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">23</span>
<span class="org-highlight-indentation"> </span>   removeBoxes([1, 3, 2, 2, 2, 3, 4, 3, 1])
<span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">9</span>
<span class="org-highlight-indentation"> </span>   removeBoxes([1,1,1])
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb0863e6" class="outline-4">
<h4 id="orgb0863e6"><span class="section-number-4">2.1.2</span> complement's DP</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
<a href="https://leetcode.com/problems/burst-balloons/">312 burst-balloons</a>
</p>

<p>
This related, and contains not only one k, but two ks for left and right.
</p>

<p>
See <a href="https://leetcode.com/problems/burst-balloons/discuss/76228/">this post</a> and <a href="https://leetcode.com/problems/burst-balloons/discuss/76229/">this</a>.
</p>

<p>
This actually <i>much easier</i>, and not related to remove boxes at all. But there's
one tricky thing to notice: <code>dp(i,j)</code> should indicates the maximum coins we get
when we <b>burst all bolloons</b> in <code>[i:j]</code>.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">def</span> <span class="org-function-name">maxCoins</span>(<span class="org-keyword">self</span>, nums: List[<span class="org-builtin">int</span>]) -&gt; <span class="org-builtin">int</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">n</span> = <span class="org-builtin">len</span>(nums)
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mem</span> = np.zeros((n, n), <span class="org-builtin">int</span>)
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">coins</span>(i, j, k):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> nums[k] * (nums[i] <span class="org-keyword">if</span> i&gt;=0 <span class="org-keyword">else</span> 1) * (nums[j] <span class="org-keyword">if</span> j&lt;n <span class="org-keyword">else</span> 1)
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">dp</span>(i, j):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">the max coins we get when we burst all bolloons [i:j]</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> i &gt; j: <span class="org-keyword">return</span> 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> i == j: <span class="org-keyword">return</span> coins(i-1,j+1,i)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> mem[i,j] &gt; 0: <span class="org-keyword">return</span> mem[i,j]

<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">cands</span> = []
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> k <span class="org-keyword">in</span> <span class="org-builtin">range</span>(i,j+1):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">cand</span> = dp(i, k-1) + dp(k+1, j) + coins(i-1, j+1, k)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   cands.append(cand)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = <span class="org-builtin">max</span>(cands)

<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mem</span>[i,j] = res
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> res
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> dp(0, n-1)

<span class="org-comment-delimiter"># </span><span class="org-comment">167</span>
maxCoins([3,1,5,8])
</pre>
</div>
</div>
</div>

<div id="outline-container-org9be45f8" class="outline-4">
<h4 id="org9be45f8"><span class="section-number-4">2.1.3</span> complement's DP</h4>
<div class="outline-text-4" id="text-2-1-3">
<p>
<a href="https://leetcode.com/problems/super-egg-drop/">887 egg drop</a>
</p>

<p>
See the first discussion in <a href="https://leetcode.com/problems/super-egg-drop/discuss/158974">this post</a>.  This looks like a number trick, but
turns out not. Looks like we have to use DP. There are several tricks:
</p>
<ol class="org-ol">
<li>Work on <b><code>dp(M,K)</code> instead of <code>dp(N,K)</code></b>. I.e. in M moves and K eggs, what is
the largest number N of floors we can check.</li>
<li>the dp equation is tricky:</li>
</ol>

<pre class="example">
dp(m,k) = dp(m-1,k-1) + dp(m-1,k) + 1
</pre>

<p>
We first try <code>dp(m-1,k-1)</code>, i.e. one less move, one less eggs, so that we have
room for next experiment. So, the first floor we try is <code>dp(m-1,k-1)+1</code>. If it
breaks, we use check the lower floors with <code>dp(m-1,k-1)</code>. If it doesn't break,
we still have <code>k</code> eggs, and we can check <code>dp(m-1,k)</code> more. Thus the equation.
</p>

<p>
Reference to <a href="https://leetcode.com/problems/number-of-music-playlists/discuss/180338">this post</a>.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> math
<span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np
<span class="org-keyword">class</span> <span class="org-type">Solution</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">superEggDrop</span>(<span class="org-keyword">self</span>, K: <span class="org-builtin">int</span>, N: <span class="org-builtin">int</span>) -&gt; <span class="org-builtin">int</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mem</span> = np.zeros((N+1,K+1), <span class="org-builtin">int</span>)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">dp</span>(m,k):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> m==0 <span class="org-keyword">or</span> k==0: <span class="org-keyword">return</span> 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> m==1 <span class="org-keyword">and</span> k==1: <span class="org-keyword">return</span> 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> mem[m,k] &gt; 0: <span class="org-keyword">return</span> mem[m,k]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = dp(m-1, k-1) + dp(m-1,k) + 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mem</span>[m,k] = res
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> res
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> m <span class="org-keyword">in</span> <span class="org-builtin">range</span>(N+1):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> dp(m,K) &gt;= N:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> m
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">assert</span> <span class="org-constant">False</span>

Solution().superEggDrop(1,2)    <span class="org-comment-delimiter"># </span><span class="org-comment">2</span>
Solution().superEggDrop(2,6)    <span class="org-comment-delimiter"># </span><span class="org-comment">3</span>
Solution().superEggDrop(3,14)   <span class="org-comment-delimiter"># </span><span class="org-comment">4</span>
Solution().superEggDrop(2,2)    <span class="org-comment-delimiter"># </span><span class="org-comment">2</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2de656c" class="outline-4">
<h4 id="org2de656c"><span class="section-number-4">2.1.4</span> Palindromic</h4>
<div class="outline-text-4" id="text-2-1-4">
<p>
<a href="https://leetcode.com/problems/count-different-palindromic-subsequences/">730. Count Different Palindromic Subsequences</a>
</p>

<p>
This could be the standard reference to Palindromic problems. It is quite
clever. Not a lot of discussions, most are pretty bad, except <a href="https://leetcode.com/problems/count-different-palindromic-subsequences/discuss/272297/DP-C%2B%2B-Clear-solution-explained">this post</a>. So the
idea:
</p>

<p>
For non-distinct:
</p>

<ul class="org-ul">
<li>dp(i,j) means the result for S[i:j]</li>
<li>if S[i] ! S[j]:
<ul class="org-ul">
<li>dp(i,j) = dp(i+1,j) + dp(i,j-1) - dp(i+1,j-1)</li>
<li>i.e. remove the overlap</li>
</ul></li>
<li>if S[i] == S[j]:
<ul class="org-ul">
<li>first, same: dp(i,j) = dp(i+1,j) + dp(i,j-1) - dp(i+1,j-1)</li>
<li>but, with additional: + dp(i+1,j-1) + 1</li>
<li>so finally: dp(i,j) = dp(i+1,j) + dp(i,j-1) + 1</li>
</ul></li>
</ul>

<p>
But non-distinct is not really meaningful. So here's the distince one:
</p>

<ul class="org-ul">
<li>dp(i,j,a) means number of distinct palindromic bordered by 'a inside S[i:j]</li>
<li>if S[i] <code>= S[j] =</code> a: <b>very important</b>
<ul class="org-ul">
<li>dp(i,j,a) = sum([dp(i+1,j-1,x) for x in a,b,c,d]) + 2</li>
</ul></li>
<li>else: dp(i,j,a) = dp(i+1,j,a) + dp(i,j-1,a) - dp(i+1,j-1,a)</li>
</ul>


<p>
<b>One more thing</b>: the initial value must be -1, otherwise there might be
infinite loop!
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">countPalindromicSubsequences</span>(<span class="org-keyword">self</span>, S: <span class="org-builtin">str</span>) -&gt; <span class="org-builtin">int</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mod</span> = 10 ** 9 + 7
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mem</span> = [[[-1 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(4)] <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(S))] <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(S))]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">dp</span>(i,j,a):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> i &gt; j: <span class="org-keyword">return</span> 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">elif</span> i == j:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> S[i] == a: <span class="org-keyword">return</span> 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">else</span>: <span class="org-keyword">return</span> 0

<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> mem[i][j][<span class="org-builtin">ord</span>(a)-<span class="org-builtin">ord</span>(<span class="org-string">'a'</span>)] &gt;= 0:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> mem[i][j][<span class="org-builtin">ord</span>(a)-<span class="org-builtin">ord</span>(<span class="org-string">'a'</span>)]

<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">number of distinct pal bordered by 'a inside S[i:j]</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> S[i] == S[j] == a:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = 2
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> b <span class="org-keyword">in</span> [<span class="org-string">'a'</span>, <span class="org-string">'b'</span>, <span class="org-string">'c'</span>, <span class="org-string">'d'</span>]:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> += dp(i+1, j-1, b)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">else</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = dp(i+1,j,a)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> += dp(i,j-1,a)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> -= dp(i+1,j-1,a)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   mem[i][j][<span class="org-builtin">ord</span>(a)-<span class="org-builtin">ord</span>(<span class="org-string">'a'</span>)] = res % mod
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> res
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> a <span class="org-keyword">in</span> [<span class="org-string">'a'</span>, <span class="org-string">'b'</span>, <span class="org-string">'c'</span>, <span class="org-string">'d'</span>]:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> += dp(0,<span class="org-builtin">len</span>(S)-1,a)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> res % mod
</pre>
</div>
</div>
</div>

<div id="outline-container-org30dc6b0" class="outline-4">
<h4 id="org30dc6b0"><span class="section-number-4">2.1.5</span> nested DP</h4>
<div class="outline-text-4" id="text-2-1-5">
<p>
<a href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock-iv/">188. Best Time to Buy and Sell Stock IV</a>
</p>

<p>
This is pretty interesting. Turns out the DP equation is not very difficulty to
write.
</p>

<ul class="org-ul">
<li><code>dp(day, ntrans)</code> means from 1:day days, up to ntrans transactions, what is
the max profit.</li>
<li>dp(day, ntrans) = max(max([dp(t,ntrans-1) + prices[day] - prices[t] for t in range(day-1)]), dp(day-1,ntrans))</li>
</ul>

<p>
The interesting part:
</p>
<ol class="org-ol">
<li>there's a loop in the DP equation</li>
<li>the loop actually turns out to be slow, and itself can be calculated using
DP, so it is "nested DP"</li>
</ol>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">maxProfit</span>(<span class="org-keyword">self</span>, k: <span class="org-builtin">int</span>, prices: List[<span class="org-builtin">int</span>]) -&gt; <span class="org-builtin">int</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-fic">HACK</span><span class="org-comment"> this fails at one test case, even to allocate the memory</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">https://leetcode.com/problems/best-time-to-buy-and-sell-stock-iv/discuss/426692/</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> k &gt; <span class="org-builtin">len</span>(prices):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(prices)-1):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> += <span class="org-builtin">max</span>(0, prices[i+1] - prices[i])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> res
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mem</span> = [[-1 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(k+1)] <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(prices))]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mem2</span> = [[<span class="org-constant">None</span> <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(k+1)] <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(prices))]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">dp2</span>(t, ntrans):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">this</span> = dp(t, ntrans) - prices[t]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> t == 0: <span class="org-keyword">return</span> this
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> mem2[t][ntrans] != <span class="org-constant">None</span>: <span class="org-keyword">return</span> mem2[t][ntrans]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = <span class="org-builtin">max</span>(dp2(t-1, ntrans), this)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   mem2[t][ntrans] = res
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> res
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">dp</span>(day, ntrans):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> day &lt;= 0: <span class="org-keyword">return</span> 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> ntrans == 0: <span class="org-keyword">return</span> 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> mem[day][ntrans] &gt;= 0: <span class="org-keyword">return</span> mem[day][ntrans]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">Non-DP solution, TLE at some test cases</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">max_tmp = 0</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">for t in range(day):</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter">#     </span><span class="org-comment">tmp = dp(t, ntrans-1)</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter">#     </span><span class="org-comment">tmp += prices[day] - prices[t]</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter">#     </span><span class="org-comment">if tmp &gt; max_tmp:</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter">#         </span><span class="org-comment">max_tmp = tmp</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">max_tmp</span> = dp2(day-1, ntrans-1) + prices[day]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   mem[day][ntrans] = <span class="org-builtin">max</span>(max_tmp, dp(day-1, ntrans))
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">print(day, ntrans, mem[day][ntrans])</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> mem[day][ntrans]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> dp(<span class="org-builtin">len</span>(prices)-1, k)
<span class="org-keyword">def</span> <span class="org-function-name">test</span>():
<span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">2</span>
<span class="org-highlight-indentation"> </span>   Solution().maxProfit(2, [2,4,1])
<span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">7</span>
<span class="org-highlight-indentation"> </span>   Solution().maxProfit(2, [3,2,6,5,0,3])
<span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">0</span>
<span class="org-highlight-indentation"> </span>   Solution().maxProfit(2, [])
<span class="org-highlight-indentation"> </span>   Solution().maxProfit(100, l)
</pre>
</div>
</div>
</div>

<div id="outline-container-orga68e184" class="outline-4">
<h4 id="orga68e184"><span class="section-number-4">2.1.6</span> FROM take 1 TO how many to take</h4>
<div class="outline-text-4" id="text-2-1-6">
<p>
<a href="https://leetcode.com/problems/pizza-with-3n-slices/">1388. Pizza With 3n Slices</a>
</p>


<p>
From <a href="https://leetcode.com/problems/pizza-with-3n-slices/discuss/546474/Python-Robber-n3-Houses-in-Cycle">this post</a>.  The trick is, not thinking about the process of taking slices,
but the process of how many slices <b>to take</b>. Here, dp(i,j,k) means from i to j,
take k slices, what's the max. There are some additional tricks for this problem:
</p>

<ol class="org-ol">
<li>use a invalid condition. The invalid condition is <code>j - i + 1 &lt; k * 2 - 1</code>,
<code>k*2</code> instead of <code>k*3</code>, because we can pick every 2 nodes without problems.</li>
<li>the initial is cycle, the that is indicated by cycle variable. Only the
initial one is 1, all other are non-cycles (i.e. i and j can be taken at the
same time)</li>
<li>we only have two branches, to take j or not</li>
</ol>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">maxSizeSlices</span>(<span class="org-keyword">self</span>, A):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">dp</span>(i, j, k, cycle=0):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> k == 1: <span class="org-keyword">return</span> <span class="org-builtin">max</span>(A[i:j + 1])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> j - i + 1 &lt; k * 2 - 1: <span class="org-keyword">return</span> -<span class="org-builtin">float</span>(<span class="org-string">'inf'</span>)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> <span class="org-builtin">max</span>(dp(i + cycle, j - 2, k - 1) + A[j], dp(i, j - 1, k))
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> dp(0, <span class="org-builtin">len</span>(A) - 1, <span class="org-builtin">len</span>(A) // 3, 1)
</pre>
</div>
</div>
</div>




<div id="outline-container-orgd38503d" class="outline-4">
<h4 id="orgd38503d"><span class="section-number-4">2.1.7</span> Other (easy) DP problems</h4>
<div class="outline-text-4" id="text-2-1-7">
</div>
<div id="outline-container-org0c34516" class="outline-5">
<h5 id="org0c34516"><span class="section-number-5">2.1.7.1</span> (5391) build-array-where-you-can-find-the-maximum-exactly-k-comparisons</h5>
<div class="outline-text-5" id="text-2-1-7-1">
<p>
<a href="https://leetcode-cn.com/contest/weekly-contest-185/problems/build-array-where-you-can-find-the-maximum-exactly-k-comparisons/">https://leetcode-cn.com/contest/weekly-contest-185/problems/build-array-where-you-can-find-the-maximum-exactly-k-comparisons/</a>
</p>

<p>
The problem is straight forward. I was using peak position and peak value
formulation, and it turned out to be complicated. A simpler "prev" just works.
</p>

<p>
Some tricks:
</p>
<ul class="org-ul">
<li>the <code>lru_cache(None)</code> is really magick for speeding up</li>
</ul>


<div class="org-src-container">
<pre class="src src-python"><span class="org-comment-delimiter"># </span><span class="org-comment">by minz-2 </span>
<span class="org-keyword">from</span> functools <span class="org-keyword">import</span> lru_cache
<span class="org-keyword">class</span> <span class="org-type">Solution</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">numOfArrays</span>(<span class="org-keyword">self</span>, n: <span class="org-builtin">int</span>, m: <span class="org-builtin">int</span>, k: <span class="org-builtin">int</span>) -&gt; <span class="org-builtin">int</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> dp(-1, n, m, k)

<span class="org-type">@lru_cache</span>(<span class="org-constant">None</span>)
<span class="org-keyword">def</span> <span class="org-function-name">dp</span>(prev, n, m, k):
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mod</span> = 10**9+7
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> n == 0:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> k == 0: <span class="org-keyword">return</span> 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">else</span>: <span class="org-keyword">return</span> 0
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> k &lt; 0: <span class="org-keyword">return</span> 0
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> mi <span class="org-keyword">in</span> <span class="org-builtin">range</span>(1,m+1):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> prev &gt;= mi:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> += dp(prev, n-1, m, k)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">else</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> += dp(mi, n-1, m, k-1)
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> res % mod
</pre>
</div>
</div>
</div>



<div id="outline-container-orga8a35d9" class="outline-5">
<h5 id="orga8a35d9"><span class="section-number-5">2.1.7.2</span> <a href="https://leetcode.com/problems/number-of-music-playlists/">(920) number of playlists</a></h5>
<div class="outline-text-5" id="text-2-1-7-2">
<p>
The second requirement is ambigious. Other than that, the DP equation is pretty
regular. However, two things worth noticing:
</p>
<ol class="org-ol">
<li>the initial condition</li>
<li>the recursion version is so much slower</li>
</ol>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">numMusicPlaylists</span>(<span class="org-keyword">self</span>, N: <span class="org-builtin">int</span>, L: <span class="org-builtin">int</span>, K: <span class="org-builtin">int</span>) -&gt; <span class="org-builtin">int</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mod</span> = 10 ** 9 + 7
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mem</span> = np.zeros((N+1, L+1), <span class="org-builtin">int</span>)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">dp</span>(n, l):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> l == 0 <span class="org-keyword">and</span> n == 0: <span class="org-keyword">return</span> 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> n == 0 <span class="org-keyword">and</span> l &gt; 0: <span class="org-keyword">return</span> 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> l == 0 <span class="org-keyword">and</span> n &gt; 0: <span class="org-keyword">return</span> 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> mem[n,l] &gt;0: <span class="org-keyword">return</span> mem[n,l]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = dp(n-1, l-1) * n + dp(n, l-1) * <span class="org-builtin">max</span>(n-K, 0)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mem</span>[n,l] = res % mod
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> mem[n,l]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">return dp(N,L) % mod</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter">#</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">ok, this is much faster!!</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mem</span>[0,0] = 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> ni <span class="org-keyword">in</span> <span class="org-builtin">range</span>(1,N+1):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> li <span class="org-keyword">in</span> <span class="org-builtin">range</span>(ni,L+1):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mem</span>[ni,li] = (mem[ni-1,li-1] * ni + mem[ni,li-1] * <span class="org-builtin">max</span>(ni-K,0)) % mod
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> mem[N,L]

Solution().numMusicPlaylists(3,3,1)  <span class="org-comment-delimiter"># </span><span class="org-comment">6</span>
Solution().numMusicPlaylists(2,3,0)  <span class="org-comment-delimiter"># </span><span class="org-comment">6</span>
Solution().numMusicPlaylists(2,3,1)  <span class="org-comment-delimiter"># </span><span class="org-comment">2</span>
Solution().numMusicPlaylists(1,1,0)  <span class="org-comment-delimiter"># </span><span class="org-comment">1</span>

Solution().numMusicPlaylists(16, 16, 4)  <span class="org-comment-delimiter"># </span><span class="org-comment">789741546</span>
Solution().numMusicPlaylists(25, 28, 5)  <span class="org-comment-delimiter"># </span><span class="org-comment">906368459</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6edc7e1" class="outline-5">
<h5 id="org6edc7e1"><span class="section-number-5">2.1.7.3</span> <a href="https://leetcode.com/contest/biweekly-contest-22/problems/cinema-seat-allocation/">1386. Cinema Seat Allocation</a></h5>
<div class="outline-text-5" id="text-2-1-7-3">
<p>
This is not hard but worth looking at:
</p>
<ol class="org-ol">
<li>use 1&lt;&lt;c trick to mark the position</li>
<li>use dictionary to record dp solutions</li>
<li>for each key not listed, simply +2 for the final solution, to save
computation instead of putting inside loop</li>
</ol>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">maxNumberOfFamilies</span>(<span class="org-keyword">self</span>, n: <span class="org-builtin">int</span>, reservedSeats: List[List[<span class="org-builtin">int</span>]]) -&gt; <span class="org-builtin">int</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">1. sort reserved seats (index by row index)</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">groups</span> = defaultdict(<span class="org-keyword">lambda</span>:[])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> (row, col) <span class="org-keyword">in</span> seats:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   groups[row].append(col)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">foo</span>(cols):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">2. calculate: a. (2,3), (4,5), (6,7), (8,9)</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">gene</span> = <span class="org-builtin">sum</span>([1 &lt;&lt; col <span class="org-keyword">for</span> col <span class="org-keyword">in</span> cols])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">one</span> = <span class="org-builtin">sum</span>(1&lt;&lt;c <span class="org-keyword">for</span> c <span class="org-keyword">in</span> [2,3,4,5])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">two</span> = <span class="org-builtin">sum</span>(1&lt;&lt;c <span class="org-keyword">for</span> c <span class="org-keyword">in</span> [4,5,6,7])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">three</span> = <span class="org-builtin">sum</span>(1&lt;&lt;c <span class="org-keyword">for</span> c <span class="org-keyword">in</span> [6,7,8,9])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">a</span> = gene &amp; one == 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">b</span> = gene &amp; two == 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">c</span> = gene &amp; three == 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> a <span class="org-keyword">and</span> c: <span class="org-keyword">return</span> 2
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">elif</span> a <span class="org-keyword">or</span> b <span class="org-keyword">or</span> c: <span class="org-keyword">return</span> 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">else</span>: <span class="org-keyword">return</span> 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> key <span class="org-keyword">in</span> groups:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> += foo(groups[key])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">for all other, +2</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> res + (n - <span class="org-builtin">len</span>(groups)) * 2
</pre>
</div>
</div>
</div>
</div>
</div>




<div id="outline-container-orgae700d5" class="outline-3">
<h3 id="orgae700d5"><span class="section-number-3">2.2</span> <span class="todo TODO">TODO</span> <a href="https://leetcode.com/tag/recursion/">recursion</a></h3>
</div>
<div id="outline-container-orgbd81d0d" class="outline-3">
<h3 id="orgbd81d0d"><span class="section-number-3">2.3</span> <span class="todo TODO">TODO</span> <a href="https://leetcode.com/tag/divide-and-conquer/">divide and conquer</a></h3>
</div>
</div>

<div id="outline-container-orga03861a" class="outline-2">
<h2 id="orga03861a"><span class="section-number-2">3</span> <span class="priority">[A]</span> special problems</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org776496a" class="outline-3">
<h3 id="org776496a"><span class="section-number-3">3.1</span> Number theory</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-orgf7f9c0e" class="outline-4">
<h4 id="orgf7f9c0e"><span class="section-number-4">3.1.1</span> <a href="https://leetcode.com/problems/largest-multiple-of-three/">1363. Largest Multiple of Three</a></h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
A typical mod-of-3 problem. The trick is to <code>reduce_147</code> (1 mod 3) or
<code>reduce_258</code> (2 mod 3) either 1 or 2 times.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">largestMultipleOfThree</span>(<span class="org-keyword">self</span>, digits: List[<span class="org-builtin">int</span>]) -&gt; <span class="org-builtin">str</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">digits</span> = <span class="org-builtin">sorted</span>(digits, reverse=<span class="org-constant">True</span>)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">d</span> = {}
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(10):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">d</span>[i] = 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> i <span class="org-keyword">in</span> digits:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">d</span>[i] += 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">construct</span>():
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = <span class="org-string">''</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(9,-1,-1):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> += <span class="org-builtin">str</span>(i) * d[i]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> <span class="org-keyword">not</span> res: <span class="org-keyword">return</span> res
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> <span class="org-builtin">str</span>(<span class="org-builtin">int</span>(res))
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">reduce_258</span>():
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> d[2] &gt;= 1: <span class="org-variable-name">d</span>[2] -= 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">elif</span> d[5] &gt;= 1: <span class="org-variable-name">d</span>[5] -= 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">elif</span> d[8] &gt;= 1: <span class="org-variable-name">d</span>[8] -= 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">else</span>: <span class="org-keyword">assert</span> <span class="org-constant">False</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">reduce_147</span>():
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> d[1] &gt;= 1: <span class="org-variable-name">d</span>[1] -= 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">elif</span> d[4] &gt;= 1: <span class="org-variable-name">d</span>[4] -= 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">elif</span> d[7] &gt;= 1: <span class="org-variable-name">d</span>[7] -= 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">else</span>: <span class="org-keyword">assert</span> <span class="org-constant">False</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> <span class="org-builtin">sum</span>(digits) % 3 == 0:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> construct()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> <span class="org-builtin">sum</span>(digits) % 3 == 1:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> d[1] + d[4] + d[7] &gt;= 1:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   reduce_147()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> construct()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">elif</span> d[2] + d[5] + d[8] &gt;= 2:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   reduce_258()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   reduce_258()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> construct()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">else</span>: <span class="org-keyword">return</span> <span class="org-string">''</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> <span class="org-builtin">sum</span>(digits) % 3 == 2:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> d[2] + d[5] + d[8] &gt;= 1:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   reduce_258()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> construct()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">elif</span> d[1] + d[4] + d[7] &gt;= 2:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   reduce_147()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   reduce_147()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> construct()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">else</span>: <span class="org-keyword">return</span> <span class="org-string">''</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org2d42705" class="outline-3">
<h3 id="org2d42705"><span class="section-number-3">3.2</span> <span class="todo TODO">TODO</span> <span class="priority">[A]</span> <a href="https://leetcode.com/tag/bit-manipulation/">bit manipulation</a></h3>
</div>


<div id="outline-container-org44f846a" class="outline-3">
<h3 id="org44f846a"><span class="section-number-3">3.3</span> <span class="todo TODO">TODO</span> <a href="https://leetcode.com/tag/union-find/">union find (29)</a></h3>
<div class="outline-text-3" id="text-3-3">
<p>
This looks interesting
</p>
</div>
</div>

<div id="outline-container-org075ff85" class="outline-3">
<h3 id="org075ff85"><span class="section-number-3">3.4</span> <span class="todo TODO">TODO</span> <a href="https://leetcode.com/tag/two-pointers/">two pointers</a></h3>
<div class="outline-text-3" id="text-3-4">
<p>
(HEBI: ??) but looks interesting
</p>
</div>
</div>

<div id="outline-container-orge7ea90c" class="outline-3">
<h3 id="orge7ea90c"><span class="section-number-3">3.5</span> <span class="todo TODO">TODO</span> <a href="https://leetcode.com/tag/sliding-window/">sliding window</a></h3>
<div class="outline-text-3" id="text-3-5">
<p>
Looks like sequence matching
</p>
</div>
</div>
</div>



<div id="outline-container-org12fa56e" class="outline-2">
<h2 id="org12fa56e"><span class="section-number-2">4</span> data structures</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-orgb46ef8d" class="outline-3">
<h3 id="orgb46ef8d"><span class="section-number-3">4.1</span> linear</h3>
<div class="outline-text-3" id="text-4-1">
</div>
<div id="outline-container-org63967ac" class="outline-4">
<h4 id="org63967ac"><span class="section-number-4">4.1.1</span> stack</h4>
</div>
<div id="outline-container-org36795bf" class="outline-4">
<h4 id="org36795bf"><span class="section-number-4">4.1.2</span> linked list</h4>
</div>
<div id="outline-container-org2554f61" class="outline-4">
<h4 id="org2554f61"><span class="section-number-4">4.1.3</span> queue</h4>
</div>
</div>

<div id="outline-container-orge231ce5" class="outline-3">
<h3 id="orge231ce5"><span class="section-number-3">4.2</span> hash table</h3>
<div class="outline-text-3" id="text-4-2">
</div>
<div id="outline-container-org79a30a1" class="outline-4">
<h4 id="org79a30a1"><span class="section-number-4">4.2.1</span> ordered map</h4>
</div>
</div>

<div id="outline-container-org5baadec" class="outline-3">
<h3 id="org5baadec"><span class="section-number-3">4.3</span> <span class="todo TODO">TODO</span> <span class="priority">[A]</span> tree</h3>
<div class="outline-text-3" id="text-4-3">
</div>
<div id="outline-container-orgf42d0a4" class="outline-5">
<h5 id="orgf42d0a4"><span class="section-number-5">4.3.0.1</span> balanced binary search tree</h5>
<div class="outline-text-5" id="text-4-3-0-1">
<p>
e.g. <a href="https://leetcode.com/problems/balance-a-binary-search-tree/">1382. Balance a Binary Search Tree</a>. You first sort the array. Then, pick
the middle as root and recursively solve the left and right.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">balanceBST</span>(<span class="org-keyword">self</span>, root: TreeNode) -&gt; TreeNode:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">1. traverse the tree, get an ordered list</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">2. construct a new BST:</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter">#    </span><span class="org-comment">- find the middle</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter">#    </span><span class="org-comment">- solve the left/right half</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">vals</span> = []
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">recur</span>(node):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> node == <span class="org-constant">None</span>: <span class="org-keyword">return</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   recur(node.left)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   vals.append(node.val)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   recur(node.right)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   recur(root)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">print</span>(vals)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">construct a new BST</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">construct</span>(low, high):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> low &gt; high: <span class="org-keyword">return</span> <span class="org-constant">None</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mid</span> = (high - low) // 2 + low
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">node</span> = TreeNode(vals[mid])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">node.left</span> = construct(low, mid-1)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">node.right</span> = construct(mid+1, high)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> node
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> construct(0, <span class="org-builtin">len</span>(vals)-1)
</pre>
</div>
</div>
</div>




<div id="outline-container-org91e8bd8" class="outline-5">
<h5 id="org91e8bd8"><span class="section-number-5">4.3.0.2</span> <a href="https://leetcode.com/problems/validate-binary-tree-nodes/">1361. Validate Binary Tree Nodes</a></h5>
<div class="outline-text-5" id="text-4-3-0-2">
<p>
This is a pretty typical problem. The tree is valid if there's no (not
necessarily directed) cycle. To do that, traverse the tree from any given point,
and record two sets:
</p>
<ul class="org-ul">
<li><code>stop</code>: current active given point. Other traversal should stop here.</li>
<li><code>done</code>: all visited nodes except the current active stop points.</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">Solution</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">validateBinaryTreeNodes</span>(<span class="org-keyword">self</span>, n: <span class="org-builtin">int</span>, leftChild: List[<span class="org-builtin">int</span>], rightChild: List[<span class="org-builtin">int</span>]) -&gt; <span class="org-builtin">bool</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">done</span> = <span class="org-builtin">set</span>()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">stop</span> = <span class="org-builtin">set</span>()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">self</span>.flag = <span class="org-constant">True</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">visit</span>(item):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">cycle</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> item <span class="org-keyword">in</span> done:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">self</span>.flag = <span class="org-constant">False</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> item <span class="org-keyword">in</span> stop:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   stop.remove(item)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   done.add(item)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">travel</span>(item):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> item == -1: <span class="org-keyword">return</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">l</span> = leftChild[item]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">r</span> = rightChild[item]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   visit(item)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">early return if cycle</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> <span class="org-keyword">self</span>.flag:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   travel(l)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   travel(r)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> <span class="org-keyword">not</span> i <span class="org-keyword">in</span> done <span class="org-keyword">and</span> <span class="org-keyword">not</span> i <span class="org-keyword">in</span> stop:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   travel(i)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   stop.add(i)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   done.remove(i)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> <span class="org-keyword">not</span> <span class="org-keyword">self</span>.flag: <span class="org-keyword">return</span> <span class="org-constant">False</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">separated graph</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> <span class="org-builtin">len</span>(stop) &gt; 1: <span class="org-keyword">return</span> <span class="org-constant">False</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">early stoped (should be unnecessary)</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> <span class="org-builtin">len</span>(done) != n-1: <span class="org-keyword">return</span> <span class="org-constant">False</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> <span class="org-constant">True</span>
</pre>
</div>
</div>
</div>




<div id="outline-container-orgbaad74e" class="outline-4">
<h4 id="orgbaad74e"><span class="section-number-4">4.3.1</span> trie</h4>
</div>
<div id="outline-container-org935a920" class="outline-4">
<h4 id="org935a920"><span class="section-number-4">4.3.2</span> heap</h4>
</div>
<div id="outline-container-orgaee87b5" class="outline-4">
<h4 id="orgaee87b5"><span class="section-number-4">4.3.3</span> segment tree</h4>
</div>
</div>

<div id="outline-container-org05c7dd1" class="outline-3">
<h3 id="org05c7dd1"><span class="section-number-3">4.4</span> <span class="todo TODO">TODO</span> <span class="priority">[A]</span> graph</h3>
</div>
</div>

<div id="outline-container-orgda10384" class="outline-2">
<h2 id="orgda10384"><span class="section-number-2">5</span> Tricky problems</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org362e517" class="outline-3">
<h3 id="org362e517"><span class="section-number-3">5.1</span> <a href="https://leetcode.com/problems/count-the-repetitions/">466. Count The Repetitions</a> (ultra large but repetitive subsequence finding)</h3>
<div class="outline-text-3" id="text-5-1">
<blockquote>
<p>
Define S = [s,n] as the string S which consists of n connected strings s. For
example, ["abc", 3] ="abcabcabc".
</p>

<p>
On the other hand, we define that string s1 can be obtained from string s2 if we
can remove some characters from s2 such that it becomes s1. For example, “abc”
can be obtained from “abdbec” based on our definition, but it can not be
obtained from “acbbe”.
</p>

<p>
You are given two non-empty strings s1 and s2 (each at most 100 characters long)
and two integers 0 ≤ n1 ≤ 106 and 1 ≤ n2 ≤ 106. Now consider the strings S1 and
S2, where S1=[s1,n1] and S2=[s2,n2]. Find the maximum integer M such that [S2,M]
can be obtained from S1.
</p>
</blockquote>

<p>
To translate:
</p>

<blockquote>
<p>
def rep(s,n) = s * n
S1 = rep(s1, n1)
S2 = rep(s2, n2)
</p>
</blockquote>


<p>
This is not DP. It is "repetitive patterns".
</p>

<p>
First, we are finding <code>s2</code> inside <code>s1</code>. Thus, we need to first have a map of
finding <code>s2</code> in <code>s1[i:]</code>:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mem</span> = [<span class="org-constant">None</span> <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(s1))]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">fill_mem</span>():
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">i</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(s1)):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">idx</span> = i
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">ct</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> c <span class="org-keyword">in</span> s2:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">idx</span> = (s1+s1).index(c, idx)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> idx + 1 &gt;= <span class="org-builtin">len</span>(s1):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">ct</span> += 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">idx</span> = (idx + 1) % <span class="org-builtin">len</span>(s1)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mem</span>[i] = (idx, ct)

<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">try</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   fill_mem()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">except</span> <span class="org-type">Exception</span> <span class="org-keyword">as</span> e:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> 0
</pre>
</div>



<p>
Then, to save computation, we need to find the repetitive patterns:
</p>

<p>
For example, we have:
</p>

<table border="2" cellspacing="2" cellpadding="6" rules="groups" frame="border">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">i</th>
<th scope="col" class="org-right">j</th>
<th scope="col" class="org-right">ct</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">5</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-right">7</td>
<td class="org-right">0</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">7</td>
<td class="org-right">9</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">7</td>
<td class="org-right">0</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">7</td>
<td class="org-right">9</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-right">3</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">7</td>
<td class="org-right">0</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">&#x2026;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Now we found the pattern. It starts from 7, takes one s1, and produces 3 s2.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">find_circle</span>():
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">use that to come up with a repetitive patten</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">repetitive</span> = <span class="org-builtin">set</span>()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">find the circle</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">i</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">while</span> <span class="org-constant">True</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> i <span class="org-keyword">in</span> repetitive: <span class="org-keyword">return</span> i
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   repetitive.add(i)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">i</span>, <span class="org-variable-name">_</span> = mem[i]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">i</span> = i % <span class="org-builtin">len</span>(s1)

<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">circle_i</span> = find_circle()
</pre>
</div>

<p>
Then, for the circle, we need to get the number of <code>s1</code> used, and the number of <code>s2</code> matched:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">find_circle_t</span>(ci):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">i</span> = ci
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">number of s1 consumed in the circle</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res_from</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">number of s2 found in the circle</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res_to</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">while</span> <span class="org-constant">True</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">i</span>, <span class="org-variable-name">c</span> = mem[i]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res_to</span> += 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res_from</span> += c
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> i &gt;= <span class="org-builtin">len</span>(s1):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res_from</span> += 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">i</span> = i % <span class="org-builtin">len</span>(s1)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> i == ci:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> res_from, res_to


<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">circle_from</span>, <span class="org-variable-name">circle_to</span> = find_circle_t(circle_i)
</pre>
</div>

<p>
Finally, we count s2 in s1 by using the repetitive pattern. The actual number
is pretty sensitivie to off-by-one problems.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">the actual count s2 in s1</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">count</span> = 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">idx</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">while</span> count &lt;= n1:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> idx == circle_i:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">fast forward</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">rep</span> = math.floor((n1 - count) / circle_from)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> += rep * circle_to
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">count</span> += rep * circle_from
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">print('fast forward', rep, res, count)</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">idx</span>, <span class="org-variable-name">ct</span> = mem[idx]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">count</span> += ct
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> += 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">if not matching exactly in the last s1, subtract one because we</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">used more</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> idx != 0: <span class="org-variable-name">res</span> -= 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">use n2 is fairly easy</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> math.floor((res - 1) / n2)
</pre>
</div>

<p>
Wow, that's a lot of code. It is possible to mix these logic together, but I
suspect that would be hard to understand.
</p>

<p>
Some tests:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">def</span> <span class="org-function-name">test</span>():
<span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">2</span>
<span class="org-highlight-indentation"> </span>   Solution().getMaxRepetitions(<span class="org-string">"acb"</span>, 4, <span class="org-string">"ab"</span>, 2)
<span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">3</span>
<span class="org-highlight-indentation"> </span>   Solution().getMaxRepetitions(<span class="org-string">"abacb"</span>, 6, <span class="org-string">"bcaa"</span>, 1)
<span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">4</span>
<span class="org-highlight-indentation"> </span>   Solution().getMaxRepetitions(<span class="org-string">"aaa"</span>, 3, <span class="org-string">"aa"</span>, 1)
<span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">2</span>
<span class="org-highlight-indentation"> </span>   Solution().getMaxRepetitions(<span class="org-string">"bacaba"</span>, 3, <span class="org-string">"abacab"</span>, 1)
<span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">0</span>
<span class="org-highlight-indentation"> </span>   Solution().getMaxRepetitions(<span class="org-string">"musicforever"</span>, 10, <span class="org-string">"lovelive"</span>, 100000)
<span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">170</span>
<span class="org-highlight-indentation"> </span>   Solution().getMaxRepetitions(<span class="org-string">"aaaaaaaaaaaaaaaaa"</span>, 10000000, <span class="org-string">"a"</span>, 1000000)
</pre>
</div>
</div>
</div>


<div id="outline-container-orgdc8f64d" class="outline-3">
<h3 id="orgdc8f64d"><span class="section-number-3">5.2</span> <a href="https://leetcode.com/contest/weekly-contest-178/problems/rank-teams-by-votes/">1366. Rank Teams by Votes</a></h3>
<div class="outline-text-3" id="text-5-2">
<ol class="org-ol">
<li>use defaultdict</li>
<li>use char as dict key</li>
<li>+1 instead of pairwise comparison matrix!!</li>
<li>sorted with multiple keys (nested tuples in this case)</li>
</ol>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> collections <span class="org-keyword">import</span> defaultdict

<span class="org-keyword">class</span> <span class="org-type">Solution</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">rankTeams</span>(<span class="org-keyword">self</span>, votes: List[<span class="org-builtin">str</span>]) -&gt; <span class="org-builtin">str</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">n</span> = <span class="org-builtin">len</span>(votes[0])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">rank</span> = defaultdict(<span class="org-keyword">lambda</span>: [0] * n)

<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">"ABC"</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">"BCA"</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">"ACB"</span>

<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> vote <span class="org-keyword">in</span> votes:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> idx, ch <span class="org-keyword">in</span> <span class="org-builtin">enumerate</span>(vote):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   rank[ch][idx] += 1

<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">d = {"A": [2,0,1],</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter">#      </span><span class="org-comment">"B": [1,1,1],</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter">#      </span><span class="org-comment">"C": [0,2,1]}</span>

<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">!!!</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">sorted([((2,0,1),'c'), ((2,0,1),'b'), ((1,1,1),'w')])</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">ranking</span> = <span class="org-builtin">sorted</span>(rank.items(), key=<span class="org-keyword">lambda</span> xs: (xs[1], -<span class="org-builtin">ord</span>(xs[0])), reverse=<span class="org-constant">True</span>)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> <span class="org-string">""</span>.join(x <span class="org-keyword">for</span> x, _ <span class="org-keyword">in</span> ranking)
</pre>
</div>

<p>
And compare to my code:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> collections <span class="org-keyword">import</span> Counter
<span class="org-keyword">from</span> functools <span class="org-keyword">import</span> cmp_to_key
<span class="org-keyword">class</span> <span class="org-type">Solution</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">rankTeams</span>(<span class="org-keyword">self</span>, votes: List[<span class="org-builtin">str</span>]) -&gt; <span class="org-builtin">str</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">n</span> = <span class="org-builtin">len</span>(votes[0])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">rank</span> = [[0 <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n)] <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n)]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">alphas</span> = votes[0]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">d</span> = {}
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> i,a <span class="org-keyword">in</span> <span class="org-builtin">enumerate</span>(alphas):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">d</span>[a] = i
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">c</span> = Counter([d[vote[i]] <span class="org-keyword">for</span> vote <span class="org-keyword">in</span> votes])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> j <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> k <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> rank[j][k] == 0:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> c[j] &gt; c[k]:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   rank[j][k] = 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">elif</span> c[j] &lt; c[k]:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   rank[j][k] = -1

<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">use the rank</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">cmp</span>(x,y):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> rank[x][y] == 0:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> <span class="org-builtin">ord</span>(alphas[y]) - <span class="org-builtin">ord</span>(alphas[x])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">else</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> rank[x][y]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = <span class="org-builtin">sorted</span>(<span class="org-builtin">range</span>(n), key=cmp_to_key(<span class="org-builtin">cmp</span>), reverse=<span class="org-constant">True</span>)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">s</span> = <span class="org-builtin">sorted</span>(votes[0], key=<span class="org-keyword">lambda</span> x: alphas[i])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> <span class="org-string">''</span>.join([s[i] <span class="org-keyword">for</span> i <span class="org-keyword">in</span> res])
</pre>
</div>
</div>
</div>



<div id="outline-container-org7a0ae4c" class="outline-3">
<h3 id="org7a0ae4c"><span class="section-number-3">5.3</span> <a href="https://leetcode.com/contest/biweekly-contest-21/problems/find-the-longest-substring-containing-vowels-in-even-counts/">1371. Find the Longest Substring Containing Vowels in Even Counts</a></h3>
<div class="outline-text-3" id="text-5-3">
<p>
<a href="https://leetcode.com/problems/find-the-longest-substring-containing-vowels-in-even-counts/discuss/531850/Python-solution-in-O(n)-time-and-O(1)-space-explained">this post</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">def</span> <span class="org-function-name">findTheLongestSubstring</span>(s: <span class="org-builtin">str</span>) -&gt; <span class="org-builtin">int</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">vowels</span> = {<span class="org-string">'a'</span>: 1, <span class="org-string">'e'</span>: 2, <span class="org-string">'i'</span>: 4, <span class="org-string">'o'</span>: 8, <span class="org-string">'u'</span>: 16}
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">d</span>, <span class="org-variable-name">n</span>, <span class="org-variable-name">r</span> = {0: -1}, 0, 0
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> i, c <span class="org-keyword">in</span> <span class="org-builtin">enumerate</span>(s):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> c <span class="org-keyword">in</span> vowels:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">n</span> ^= vowels[c]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> n <span class="org-keyword">not</span> <span class="org-keyword">in</span> d:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">d</span>[n] = i
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">else</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">r</span> = <span class="org-builtin">max</span>(r, i - d[n])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">print</span>(d, i, n, r)
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> r
</pre>
</div>


<p>
The trick is: scan the string from left to right, and <b>record the current status
of even or odd of 'aeiou'</b>.
</p>

<p>
Or maybe better for understanding:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">def</span> <span class="org-function-name">encode</span>(l):
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(l)):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> += l[i] &lt;&lt; i
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> res
<span class="org-keyword">def</span> <span class="org-function-name">findsub</span>(s):
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">status</span> = [0,0,0,0,0]
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">d</span> = {0: -1}
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">m</span> = {<span class="org-string">'a'</span>: 0, <span class="org-string">'e'</span>: 1, <span class="org-string">'i'</span>: 2, <span class="org-string">'o'</span>: 3, <span class="org-string">'u'</span>: 4}
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> i,c <span class="org-keyword">in</span> <span class="org-builtin">enumerate</span>(s):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> c <span class="org-keyword">in</span> m:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   status[m[c]] ^= 1
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">enc</span> = encode(status)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">print</span>(status)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> enc <span class="org-keyword">not</span> <span class="org-keyword">in</span> d:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">d</span>[enc] = i
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">else</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = <span class="org-builtin">max</span>(res, i-d[enc])
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> res
</pre>
</div>


<p>
Note some tricks:
</p>
<ol class="org-ol">
<li>use dict m instead of calling ord and chr</li>
<li>status can be just encoded as bits in a number</li>
</ol>

<p>
My bad solution using deque and divide and conquer:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> collections <span class="org-keyword">import</span> deque

<span class="org-keyword">class</span> <span class="org-type">Solution</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">findTheLongestSubstring</span>(<span class="org-keyword">self</span>, s: <span class="org-builtin">str</span>) -&gt; <span class="org-builtin">int</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">1. find the index of aeiou</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">2. merge the index</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">I actually don't need to record all indices</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">qs</span> = [deque() <span class="org-keyword">for</span> _ <span class="org-keyword">in</span> <span class="org-builtin">range</span>(5)]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> i,c <span class="org-keyword">in</span> <span class="org-builtin">enumerate</span>(s):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> c == <span class="org-string">'a'</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   qs[0].append(i)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> c == <span class="org-string">'e'</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   qs[1].append(i)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> c == <span class="org-string">'i'</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   qs[2].append(i)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> c == <span class="org-string">'o'</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   qs[3].append(i)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> c == <span class="org-string">'u'</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   qs[4].append(i)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">print(qs)</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">mem</span> = []
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">recur</span>(qs, start, end):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> start &gt; end: <span class="org-keyword">return</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> s,e <span class="org-keyword">in</span> mem:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> start &gt; s <span class="org-keyword">and</span> end &lt; e: <span class="org-keyword">return</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">modify qs</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">nonlocal</span> res
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> q <span class="org-keyword">in</span> qs:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">while</span> <span class="org-builtin">len</span>(q) &gt; 0 <span class="org-keyword">and</span> q[0] &lt; start:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   q.popleft()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">while</span> <span class="org-builtin">len</span>(q) &gt; 0 <span class="org-keyword">and</span> q[-1] &gt; end:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   q.pop()
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">check if even</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> q <span class="org-keyword">in</span> qs:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> <span class="org-builtin">len</span>(q) % 2 == 1:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   recur([q.copy() <span class="org-keyword">for</span> q <span class="org-keyword">in</span> qs], q[0]+1, end)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   recur([q.copy() <span class="org-keyword">for</span> q <span class="org-keyword">in</span> qs], start, q[-1]-1)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   mem.append((start, end))
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span> = <span class="org-builtin">max</span>(res, end - start + 1)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   mem.append((start, end))
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   recur(qs, 0, <span class="org-builtin">len</span>(s)-1)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> res
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd551e52" class="outline-3">
<h3 id="orgd551e52"><span class="section-number-3">5.4</span> <a href="https://leetcode.com/contest/weekly-contest-180/problems/maximum-performance-of-a-team/">5359. Maximum Performance of a Team</a></h3>
<div class="outline-text-3" id="text-5-4">
<p>
See <a href="https://leetcode.com/problems/maximum-performance-of-a-team/discuss/539711/Python-Heap">this post</a>. The idea is to first order engineers by efficiency then by
speed. Add the first k, keep track of the current efficiency (actually is the
current engineer).
</p>

<p>
Then, swap out the lowest speed with current engineer. Record the max result
each time.
</p>

<p>
Another point is keep an eye on the <a href="https://docs.python.org/3.8/library/heapq.html">heapq</a> python library.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> heapq
<span class="org-keyword">class</span> <span class="org-type">Solution</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">maxPerformance</span>(<span class="org-keyword">self</span>, n: <span class="org-builtin">int</span>, speed: List[<span class="org-builtin">int</span>], efficiency: List[<span class="org-builtin">int</span>], k: <span class="org-builtin">int</span>) -&gt; <span class="org-builtin">int</span>:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">engineers</span> = [(speed[i],efficiency[i]) <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n)]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   engineers.sort(key = <span class="org-keyword">lambda</span> x : (-x[1],x[0]))
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">result</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">heap</span> = []
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">totalSum</span> = 0
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">print</span>(engineers)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(n):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">while</span> <span class="org-builtin">len</span>(heap) &gt;= k:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">totalSum</span> -= heapq.heappop(heap)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">result</span> = <span class="org-builtin">max</span>(result , (totalSum + engineers[i][0]) * engineers[i][1] )
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   heapq.heappush(heap,engineers[i][0])
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">print</span>(heap, result)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">totalSum</span> += engineers[i][0]
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> result % (10 ** 9 + 7)
</pre>
</div>
</div>
</div>


<div id="outline-container-orgfb5f1f2" class="outline-3">
<h3 id="orgfb5f1f2"><span class="section-number-3">5.5</span> <a href="https://leetcode.com/problems/longest-happy-prefix/">1392. Longest Happy Prefix</a></h3>
<div class="outline-text-3" id="text-5-5">
<p>
This seems to be just KMP (TODO).
</p>

<p>
An interesting hashing solution in <a href="https://leetcode.com/problems/longest-happy-prefix/discuss/547237/Python-Rolling-Hash">this post</a>:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">def</span> <span class="org-function-name">longestPrefix</span>(<span class="org-keyword">self</span>, s):
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">res</span>, <span class="org-variable-name">l</span>, <span class="org-variable-name">r</span>, <span class="org-variable-name">mod</span> = 0, 0, 0, 10**9 + 7
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">xrange</span>(<span class="org-builtin">len</span>(s) - 1):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">l</span> = (l * 128 + <span class="org-builtin">ord</span>(s[i])) % mod
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-variable-name">r</span> = (r + <span class="org-builtin">pow</span>(128, i, mod) * <span class="org-builtin">ord</span>(s[~i])) % mod
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">if</span> l == r: <span class="org-variable-name">res</span> = i + 1
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> s[:res]
</pre>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
