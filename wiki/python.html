<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Python, the language</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="/home/hebi/git/homepage/assets/org.css" /><link rel="stylesheet" type="text/css" href="/home/hebi/git/homepage/assets/hebi.css" /><link rel="stylesheet" type="text/css" href="/assets/org.css" /><link rel="stylesheet" type="text/css" href="/assets/hebi.css" />
<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.cacheClassElem = elem.className;
         elem.cacheClassTarget = target.className;
         target.className = "code-highlighted";
         elem.className   = "code-highlighted";
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(elem.cacheClassElem)
         elem.className = elem.cacheClassElem;
       if(elem.cacheClassTarget)
         target.className = elem.cacheClassTarget;
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href=""> UP </a>
 |
 <a accesskey="H" href="/"> HOME </a>
</div><div id="content">
<h1 class="title">Python, the language</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orga53ea3a">1. Tools &amp; Reference</a>
<ul>
<li><a href="#orge7c958a">1.1. Emacs support</a></li>
<li><a href="#org2dc1245">1.2. pip mirror</a></li>
</ul>
</li>
<li><a href="#org3dd7905">2. Language</a>
<ul>
<li><a href="#org21a971e">2.1. data type</a>
<ul>
<li><a href="#org695d94e">2.1.1. conversion</a></li>
</ul>
</li>
<li><a href="#orgff5b7e5">2.2. Scoping</a></li>
<li><a href="#org9cd5cdd">2.3. Conditional</a></li>
<li><a href="#orgc491eeb">2.4. Loop</a></li>
<li><a href="#org7abf834">2.5. Function</a>
<ul>
<li><a href="#org8ea658a">2.5.1. Function def and call</a></li>
<li><a href="#orgf88becd">2.5.2. Lambda</a></li>
<li><a href="#orgb7c6e60">2.5.3. variadic parameter</a></li>
</ul>
</li>
<li><a href="#orga2325f8">2.6. Meta Programming</a></li>
<li><a href="#orgf81ce1e">2.7. Exception</a>
<ul>
<li><a href="#org0f88faa">2.7.1. Built-in exceptions</a></li>
</ul>
</li>
<li><a href="#org7c356a9">2.8. Module</a>
<ul>
<li><a href="#org323f06d">2.8.1. importing</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org1aa7b29">3. Collections</a>
<ul>
<li><a href="#org5d4eaa6">3.1. List</a>
<ul>
<li><a href="#org05c6426">3.1.1. <span class="todo TODO">TODO</span> tuple</a></li>
<li><a href="#orge30b3c8">3.1.2. <span class="todo TODO">TODO</span> sorted</a></li>
<li><a href="#orgbcd10a2">3.1.3. Slicing</a></li>
<li><a href="#org6109fb5">3.1.4. create a list</a></li>
<li><a href="#org09602fe">3.1.5. Modify a list</a></li>
<li><a href="#orgb0fac36">3.1.6. List object model</a></li>
</ul>
</li>
<li><a href="#orga7f4df5">3.2. String</a>
<ul>
<li><a href="#orge6d8f51">3.2.1. Concatenation</a></li>
<li><a href="#orgc0da037">3.2.2. split</a></li>
<li><a href="#orga7a8713">3.2.3. Slicing</a></li>
</ul>
</li>
<li><a href="#orgdc8e2b5">3.3. Dictionary</a>
<ul>
<li><a href="#orgf5c3068">3.3.1. Set</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org07a9e3a">4. Standard Library</a>
<ul>
<li><a href="#org0802d7b">4.1. Operating System</a>
<ul>
<li><a href="#org752ce55">4.1.1. Env</a></li>
<li><a href="#org405a31a">4.1.2. Shell command</a></li>
<li><a href="#orga85a2db">4.1.3. Process</a></li>
</ul>
</li>
<li><a href="#org67f30cd">4.2. IO</a>
<ul>
<li><a href="#org516fa87">4.2.1. File IO</a></li>
<li><a href="#org34cc250">4.2.2. Printing</a></li>
<li><a href="#org1ae6de4">4.2.3. redirect stdout</a></li>
</ul>
</li>
<li><a href="#orgeaaea94">4.3. File System</a>
<ul>
<li><a href="#org6ba95b0">4.3.1. os.walk</a></li>
<li><a href="#org5dbd6c8">4.3.2. FS Operations</a></li>
<li><a href="#org80f5e75">4.3.3. shutil</a></li>
<li><a href="#org0a0992a">4.3.4. os.path</a></li>
<li><a href="#orge15c130">4.3.5. pathlib</a></li>
<li><a href="#org67beb3e">4.3.6. <span class="todo TODO">TODO</span> tempfile</a></li>
</ul>
</li>
<li><a href="#orgd4cb2cc">4.4. unittest</a></li>
<li><a href="#org05942f1">4.5. time</a>
<ul>
<li><a href="#orgf3b1238">4.5.1. datetime</a></li>
</ul>
</li>
<li><a href="#orgb5f46d3">4.6. csv</a></li>
<li><a href="#org12bca49">4.7. Json</a></li>
<li><a href="#org9c9b9d7">4.8. argparse</a></li>
<li><a href="#org1f1ffcd">4.9. Regular Expression</a></li>
<li><a href="#org1b06186">4.10. Concurrent programming</a>
<ul>
<li><a href="#org79936b4">4.10.1. threading</a></li>
<li><a href="#orga975ab0">4.10.2. Thread Sync</a>
<ul>
<li><a href="#org4bfce27">4.10.2.1. Using with statement</a></li>
</ul>
</li>
<li><a href="#orge3a65e4">4.10.3. multiprocessing</a></li>
<li><a href="#org072564c">4.10.4. subprocess</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgd1cac5f">5. Third party libraries</a>
<ul>
<li><a href="#orgc871cc2">5.1. urllib</a>
<ul>
<li><a href="#org0e1693b">5.1.1. urllib.request</a></li>
<li><a href="#orgce7ccce">5.1.2. urllib.parse</a></li>
</ul>
</li>
<li><a href="#orgbe56383">5.2. XML</a></li>
<li><a href="#orgef30665">5.3. Requests</a></li>
<li><a href="#org5d4f44c">5.4. BeautifulSoup</a></li>
<li><a href="#org058f4a1">5.5. click http://click.pocoo.org/5/</a></li>
<li><a href="#orge09c442">5.6. pandas</a></li>
<li><a href="#org659e007">5.7. numpy</a></li>
<li><a href="#org9ce2f52">5.8. scipy</a></li>
<li><a href="#org1aca3d9">5.9. scikit-learn</a></li>
<li><a href="#org22bd492">5.10. matplotlib</a>
<ul>
<li><a href="#orgff4598a">5.10.1. type of figures</a></li>
<li><a href="#org330da02">5.10.2. <span class="todo TODO">TODO</span> plot options</a></li>
<li><a href="#orgc617e06">5.10.3. legends, axis, more settings</a></li>
<li><a href="#orgf1a5a45">5.10.4. Subplots</a></li>
<li><a href="#orgc1dca5f">5.10.5. export to files</a></li>
</ul>
</li>
<li><a href="#org6746aae">5.11. imsave</a></li>
<li><a href="#org7e1f6b1">5.12. Nvidia GPU setting</a></li>
</ul>
</li>
</ul>
</div>
</div>
<blockquote>
<p>
Pseudocode which runs. &#x2013; Peter Norvig (?)
</p>
</blockquote>

<blockquote>
<p>
The best program to do a job is one which already ships the solution.
</p>
</blockquote>

<blockquote>
<p>
There should be one – and preferably only one – obvious way to do it.
</p>

<p>
&#x2013; Aphorism 13 in the Zen of Python by Tim Peters:
</p>
</blockquote>

<p>
Python is nice, sure.  But only until it stats warping your mind in
the very late of the game. See <a href="https://www.draketo.de/proj/py2guile/">https://www.draketo.de/proj/py2guile/</a>
for an insightful reference.
</p>

<blockquote>
<p>
When you start thinking about using code-templates in your editor to
comply with the requirements of your language, then it is likely that
something is wrong with the language.
</p>
</blockquote>

<div id="outline-container-orga53ea3a" class="outline-2">
<h2 id="orga53ea3a"><span class="section-number-2">1</span> Tools &amp; Reference</h2>
<div class="outline-text-2" id="text-1">
<p>
For python 3
</p>
<ul class="org-ul">
<li><a href="https://docs.python.org/3/reference/">https://docs.python.org/3/reference/</a></li>
<li><a href="https://docs.python.org/3/library/">https://docs.python.org/3/library/</a></li>
</ul>
</div>

<div id="outline-container-orge7c958a" class="outline-3">
<h3 id="orge7c958a"><span class="section-number-3">1.1</span> Emacs support</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Install the <code>elpy</code> package. It provides:
</p>
<ul class="org-ul">
<li><code>C-c C-c</code> runs the shell and send the current buffer</li>
<li><code>C-c C-d</code> runs <code>elpy-doc</code></li>
<li><code>C-c C-t</code> runs <code>elpy-test</code>, which runs the unittest discover</li>
</ul>

<p>
To enable linter python in emacs, use pylint. It will use <code>pylint</code>
executable. And it also needs the configure file. Generate it:
</p>

<pre class="example">
pylint --generate-rcfile &gt; ~/.pylintrc
</pre>
</div>
</div>
<div id="outline-container-org2dc1245" class="outline-3">
<h3 id="org2dc1245"><span class="section-number-3">1.2</span> pip mirror</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>ustc mirror: <a href="http://pypi.mirrors.ustc.edu.cn/simple/">http://pypi.mirrors.ustc.edu.cn/simple/</a></li>
</ul>

<p>
to use one-time, simply:
</p>

<pre class="example">
pip3 install xxx -i https://pypi.mirrors.ustc.edu.cn/simple/

# don't need this when using https
# --trusted-host pypi.mirrors.ustc.edu.cn
</pre>

<p>
global configuration <b>seems</b> to be:
</p>
<pre class="example">
pip3 config set global.index-url https://mirrors.ustc.edu.cn/pypi/web/simple
</pre>

<p>
In China, pytorch cannot be installed due to 1. large 2. cpu only has a specific
url. Thus I'm using conda mirror <a href="https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/">https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org3dd7905" class="outline-2">
<h2 id="org3dd7905"><span class="section-number-2">2</span> Language</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org21a971e" class="outline-3">
<h3 id="org21a971e"><span class="section-number-3">2.1</span> data type</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>type(obj): get the type of obj</li>
</ul>

<p>
Numerical functions:
</p>
<ul class="org-ul">
<li>abs(x): absolute value</li>
<li>divmod(a,b): a pair (a // b, a % b)</li>
<li>max(arg1, arg2, *args)</li>
<li>min(arg1, arg2, *args)</li>
<li>pow(x,y): x<sup>y</sup></li>
<li>round(x, ndigits=0)</li>
<li>sum(iterable)</li>
</ul>

<p>
Boolean:
</p>
<ul class="org-ul">
<li>all(iterable): true if all items are true. empty =&gt; True</li>
<li>any(iterable): true if any item is true. empty =&gt; False</li>
<li>cmp(x,y)
<ul class="org-ul">
<li>x&lt;y =&gt; negative</li>
<li>x=y =&gt; 0</li>
<li>x&gt;y =&gt; positive</li>
</ul></li>
</ul>
</div>

<div id="outline-container-org695d94e" class="outline-4">
<h4 id="org695d94e"><span class="section-number-4">2.1.1</span> conversion</h4>
<div class="outline-text-4" id="text-2-1-1">
<ul class="org-ul">
<li><code>chr()</code>: ASCII to char</li>
<li><code>ord()</code>: char to ASCII</li>

<li><code>float(x)</code></li>
<li><code>long(x)</code></li>
<li><code>bool(x)</code>: convert x to bool</li>
<li><code>int()</code>: string to integer</li>
<li><code>str()</code>: integer to string
<ul class="org-ul">
<li><code>hex(x)</code>: convert integer to lowercase hex string prefix with '0x'</li>
<li><code>oct(x)</code>: integer to octal string</li>
<li><code>bin(x)</code>: an integer to binary string</li>
</ul></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgff5b7e5" class="outline-3">
<h3 id="orgff5b7e5"><span class="section-number-3">2.2</span> Scoping</h3>
<div class="outline-text-3" id="text-2-2">
<p>
There're four levels:
</p>
<ul class="org-ul">
<li>current scope</li>
<li>parent scope</li>
<li>module scope (global)</li>
<li>built-in scope</li>
</ul>

<p>
<code>nonlocal</code> keyword specify this variable should be referenced to the parent scope.
But, this will not reach global.
Instead, the <code>global</code> keyword declares the listed variables to be in the module level scope.
</p>

<blockquote>
<p>
The nonlocal statement causes the listed identifiers to refer to previously bound variables in the nearest enclosing scope excluding globals.
</p>
</blockquote>

<p>
As an example:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">var</span> = 0 <span class="org-comment-delimiter"># </span><span class="org-comment">global</span>

<span class="org-keyword">def</span> <span class="org-function-name">outer</span>():
<span class="org-highlight-indentation"> </span> <span class="org-variable-name">var</span> = 1 <span class="org-comment-delimiter"># </span><span class="org-comment">parent</span>
<span class="org-highlight-indentation"> </span> <span class="org-keyword">def</span> <span class="org-function-name">inner</span>():
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">nonlocal</span> var
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">var</span> = 2 <span class="org-comment-delimiter"># </span><span class="org-comment">local</span>
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">global</span> var
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">var</span> =3
<span class="org-highlight-indentation"> </span> inner()
<span class="org-highlight-indentation"> </span> <span class="org-comment-delimiter"># </span><span class="org-comment">var = 2</span>

outer()
<span class="org-comment-delimiter"># </span><span class="org-comment">global var = 3</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9cd5cdd" class="outline-3">
<h3 id="org9cd5cdd"><span class="section-number-3">2.3</span> Conditional</h3>
<div class="outline-text-3" id="text-2-3">
<p>
If else or:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">var</span> = d.get(<span class="org-string">'key'</span>) <span class="org-keyword">or</span> 0
<span class="org-comment-delimiter"># </span><span class="org-comment">is equal to:</span>
<span class="org-variable-name">var</span> = d.get(<span class="org-string">'key'</span>) <span class="org-keyword">if</span> d.get(<span class="org-string">'key'</span>) <span class="org-keyword">else</span> 0
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc491eeb" class="outline-3">
<h3 id="orgc491eeb"><span class="section-number-3">2.4</span> Loop</h3>
<div class="outline-text-3" id="text-2-4">
<ul class="org-ul">
<li>len(s): length</li>
<li>next(iterator)</li>
<li>range(stop): [0,stop)</li>
<li>range(start, stop, step=1)</li>
</ul>
</div>
</div>


<div id="outline-container-org7abf834" class="outline-3">
<h3 id="org7abf834"><span class="section-number-3">2.5</span> Function</h3>
<div class="outline-text-3" id="text-2-5">
</div>
<div id="outline-container-org8ea658a" class="outline-4">
<h4 id="org8ea658a"><span class="section-number-4">2.5.1</span> Function def and call</h4>
<div class="outline-text-4" id="text-2-5-1">
<p>
The default value of an argument is evaluated once at the function
definition. Thus, the object is shared for all the invoke of the
function. This is typically not desired behavior.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">def</span> <span class="org-function-name">foo</span>(a=[]):
<span class="org-highlight-indentation"> </span>   a.append(3)
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> a
foo()
foo()
<span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; [3,3] !!!</span>
</pre>
</div>

<p>
Python function pass-by-object. If you pass a list, you can modify the
list, and the original list is modified.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">a</span> = [1,2]
<span class="org-keyword">def</span> <span class="org-function-name">foo</span>(x):
<span class="org-highlight-indentation"> </span>   x.append(3)
foo(a)
a <span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; [1,2,3]</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf88becd" class="outline-4">
<h4 id="orgf88becd"><span class="section-number-4">2.5.2</span> Lambda</h4>
<div class="outline-text-4" id="text-2-5-2">
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">lambda</span> x : x+2
<span class="org-keyword">lambda</span> x: x%2==0
</pre>
</div>

<p>
The usage of lambda is often in <i>map</i> and <i>filter</i>.
</p>
<ul class="org-ul">
<li><code>map(lambda_exp, mylist)</code> will execute the lambda expression on each element
of the list, and return a list containing the results.</li>
</ul>
</div>
</div>
<div id="outline-container-orgb7c6e60" class="outline-4">
<h4 id="orgb7c6e60"><span class="section-number-4">2.5.3</span> variadic parameter</h4>
<div class="outline-text-4" id="text-2-5-3">
<p>
use <code>*args</code> syntax, and <code>args</code> will be a <i>tuple</i>:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-highlight-indentation"> </span> <span class="org-keyword">def</span> <span class="org-function-name">foo</span>(*args):
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> a <span class="org-keyword">in</span> args:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span> <span class="org-keyword">print</span> a
</pre>
</div>

<p>
use <code>**args</code> to capture all <i>keyword arguments</i>.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">def</span> <span class="org-function-name">bar</span>(**kwargs):
<span class="org-highlight-indentation"> </span> <span class="org-keyword">for</span> a <span class="org-keyword">in</span> kwargs:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">print</span> a, kwargs[a]
</pre>
</div>

<p>
Combine them together:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">def</span> <span class="org-function-name">foobar</span>(kind, *args, **kwargs):
<span class="org-highlight-indentation"> </span> <span class="org-keyword">pass</span>
</pre>
</div>

<p>
Also, there's a concept for the reverse thing: unpack argument list from a list, with <code>*list</code>:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">def</span> <span class="org-function-name">foo</span>(a,b):
<span class="org-highlight-indentation"> </span> <span class="org-keyword">pass</span>

<span class="org-variable-name">l</span> = [1,2]
foo(*l)
</pre>
</div>

<p>
on python3, this syntax can appear on left side
</p>
<div class="org-src-container">
<pre class="src src-python">first, *<span class="org-variable-name">rest</span> = [1,2,3,4]
first,*<span class="org-variable-name">l</span>,<span class="org-variable-name">last</span> = [1,2,3,4]
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orga2325f8" class="outline-3">
<h3 id="orga2325f8"><span class="section-number-3">2.6</span> Meta Programming</h3>
<div class="outline-text-3" id="text-2-6">
<p>
Basically <code>eval</code> (return value) and <code>exec</code> (no return value), with
either string or <i>code object</i> created by <code>compile</code>. They can use the
names bound by current namespace.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-builtin">eval</span>(<span class="org-string">"1+2"</span>)
<span class="org-variable-name">a</span>=2
<span class="org-builtin">eval</span>(<span class="org-string">"1+a"</span>)
<span class="org-keyword">def</span> <span class="org-function-name">foo</span>(a):
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">return</span> a+3
<span class="org-builtin">eval</span>(<span class="org-string">"foo(a)"</span>)
<span class="org-comment-delimiter"># </span><span class="org-comment">no return</span>
<span class="org-keyword">exec</span>(<span class="org-string">"foo(a)"</span>)
<span class="org-builtin">eval</span>(<span class="org-builtin">compile</span>(<span class="org-string">"1+a"</span>, <span class="org-string">''</span>, <span class="org-string">'eval'</span>))
</pre>
</div>
</div>
</div>


<div id="outline-container-orgf81ce1e" class="outline-3">
<h3 id="orgf81ce1e"><span class="section-number-3">2.7</span> Exception</h3>
<div class="outline-text-3" id="text-2-7">
<p>
To give a quick feel:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">try</span>:
<span class="org-highlight-indentation"> </span> <span class="org-keyword">pass</span>
<span class="org-keyword">except</span> <span class="org-type">TypeError</span> <span class="org-keyword">as</span> e: <span class="org-comment-delimiter"># </span><span class="org-comment">capture the exception into a variable</span>
<span class="org-highlight-indentation"> </span> <span class="org-keyword">pass</span>
<span class="org-keyword">except</span> AnotherError: <span class="org-comment-delimiter"># </span><span class="org-comment">does not capture</span>
<span class="org-highlight-indentation"> </span> <span class="org-keyword">pass</span>
<span class="org-keyword">except</span>: <span class="org-comment-delimiter"># </span><span class="org-comment">all exception</span>
<span class="org-highlight-indentation"> </span> <span class="org-keyword">pass</span>
<span class="org-keyword">else</span>: <span class="org-comment-delimiter"># </span><span class="org-comment">if doesn't raise an exception</span>
<span class="org-highlight-indentation"> </span> <span class="org-keyword">pass</span>
<span class="org-keyword">finally</span>:
<span class="org-highlight-indentation"> </span> <span class="org-keyword">pass</span>
</pre>
</div>
</div>

<div id="outline-container-org0f88faa" class="outline-4">
<h4 id="org0f88faa"><span class="section-number-4">2.7.1</span> Built-in exceptions</h4>
<div class="outline-text-4" id="text-2-7-1">
<pre class="example">
BaseException
 +-- SystemExit
 +-- KeyboardInterrupt
 +-- GeneratorExit
 +-- Exception
      +-- StopIteration
      +-- StandardError
      |    +-- BufferError
      |    +-- ArithmeticError
      |    |    +-- FloatingPointError
      |    |    +-- OverflowError
      |    |    +-- ZeroDivisionError
      |    +-- AssertionError
      |    +-- AttributeError
      |    +-- EnvironmentError
      |    |    +-- IOError
      |    |    +-- OSError
      |    |         +-- WindowsError (Windows)
      |    |         +-- VMSError (VMS)
      |    +-- EOFError
      |    +-- ImportError
      |    +-- LookupError
      |    |    +-- IndexError
      |    |    +-- KeyError
      |    +-- MemoryError
      |    +-- NameError
      |    |    +-- UnboundLocalError
      |    +-- ReferenceError
      |    +-- RuntimeError
      |    |    +-- NotImplementedError
      |    +-- SyntaxError
      |    |    +-- IndentationError
      |    |         +-- TabError
      |    +-- SystemError
      |    +-- TypeError
      |    +-- ValueError
      |         +-- UnicodeError
      |              +-- UnicodeDecodeError
      |              +-- UnicodeEncodeError
      |              +-- UnicodeTranslateError
      +-- Warning
           +-- DeprecationWarning
           +-- PendingDeprecationWarning
           +-- RuntimeWarning
           +-- SyntaxWarning
           +-- UserWarning
           +-- FutureWarning
	   +-- ImportWarning
	   +-- UnicodeWarning
	   +-- BytesWarning
</pre>
</div>
</div>
</div>


<div id="outline-container-org7c356a9" class="outline-3">
<h3 id="org7c356a9"><span class="section-number-3">2.8</span> Module</h3>
<div class="outline-text-3" id="text-2-8">
<p>
Exposing API: the following only expose <code>foo</code> but not <code>bar</code>.
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-builtin">__all__</span> = [<span class="org-string">'foo'</span>]
<span class="org-keyword">def</span> <span class="org-function-name">foo</span>():
<span class="org-highlight-indentation"> </span> <span class="org-keyword">pass</span>
<span class="org-keyword">def</span> <span class="org-function-name">bar</span>():
<span class="org-highlight-indentation"> </span> <span class="org-keyword">pass</span>
</pre>
</div>
</div>

<div id="outline-container-org323f06d" class="outline-4">
<h4 id="org323f06d"><span class="section-number-4">2.8.1</span> importing</h4>
<div class="outline-text-4" id="text-2-8-1">
<p>
The local structure directory must contain the <code>__init__.py</code> file to be able to import.
</p>
<pre class="example">
|-- main.py
|-- mypackage
    |-- __init__.py
    |-- a.py
    |-- b.py
    |-- subdir
        |-- __init__.py
        |-- c.py
</pre>

<p>
The import statements should be:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> mypackage <span class="org-keyword">import</span> a
<span class="org-keyword">from</span> mypackage.b <span class="org-keyword">import</span> foo <span class="org-keyword">as</span> myfoo
<span class="org-keyword">from</span> mypackage.subdir <span class="org-keyword">import</span> c
</pre>
</div>

<pre class="example">
export PYTHONPATH="$PYTHONPATH:/home/hebi/github/reading/models"
</pre>

<p>
Add some path so that I can import from there:
</p>
<div class="org-src-container">
<pre class="src src-python">sys.path.append(<span class="org-string">'/home/hebi/github/reading/InferSent/'</span>)
<span class="org-comment-delimiter"># </span><span class="org-comment">assume in root of that directory, models.py defines InferSent class</span>
<span class="org-keyword">from</span> models <span class="org-keyword">import</span> InferSent
</pre>
</div>

<p>
Packaging:
</p>

<p>
setup.py:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> setuptools <span class="org-keyword">import</span> setup, find_packages
setup(
<span class="org-highlight-indentation"> </span>   name=<span class="org-string">"InferSent-Mirror"</span>,
<span class="org-highlight-indentation"> </span>   version=<span class="org-string">"0.1"</span>,
<span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">packages=find_packages(),</span>
<span class="org-highlight-indentation"> </span>   packages=[<span class="org-string">'p1'</span>, <span class="org-string">'p2'</span>],
)
</pre>
</div>

<p>
Directory structure:
</p>
<pre class="example">
mypackage/
  p1/
    __init__.py
    xxx.py
  p2/
    __init__.py
    yyy.py
</pre>

<p>
Install locally:
</p>
<pre class="example">
python3 setup.py install --user
</pre>

<p>
Install from git repo:
</p>
<pre class="example">
pip install --user git+https://github.com/lihebi/InferSent
</pre>

<p>
Import:
</p>
<pre class="example">
from p1 import xxx
from p2.yyy import foo
</pre>
</div>
</div>
</div>
</div>



<div id="outline-container-org1aa7b29" class="outline-2">
<h2 id="org1aa7b29"><span class="section-number-2">3</span> Collections</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org5d4eaa6" class="outline-3">
<h3 id="org5d4eaa6"><span class="section-number-3">3.1</span> List</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org05c6426" class="outline-4">
<h4 id="org05c6426"><span class="section-number-4">3.1.1</span> <span class="todo TODO">TODO</span> tuple</h4>
</div>
<div id="outline-container-orge30b3c8" class="outline-4">
<h4 id="orge30b3c8"><span class="section-number-4">3.1.2</span> <span class="todo TODO">TODO</span> sorted</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
sort a dictionary by value:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-builtin">sorted</span>(dict1, key=dict1.get) <span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; list</span>
<span class="org-builtin">sorted</span>(dict1, key=dict1.get, reverse=<span class="org-constant">True</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbcd10a2" class="outline-4">
<h4 id="orgbcd10a2"><span class="section-number-4">3.1.3</span> Slicing</h4>
<div class="outline-text-4" id="text-3-1-3">
<p>
The slicing syntax is <code>l[start:end:step]</code>.
The slicing will return a <i>new</i> list. Change to that list will not change the original one.
</p>
<div class="org-src-container">
<pre class="src src-python">l[4]
l[4:]
l[::2]
l[:-1]
</pre>
</div>

<p>
However, assign to the slicing itself <i>will change</i> the original one:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">l</span>[1:2] = [4,5,6]
</pre>
</div>

<p>
Also, assign to a new variable only assign the reference:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">a</span> = [1,2,3]
<span class="org-variable-name">b</span> = a <span class="org-comment-delimiter"># </span><span class="org-comment">only a reference</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6109fb5" class="outline-4">
<h4 id="org6109fb5"><span class="section-number-4">3.1.4</span> create a list</h4>
<div class="outline-text-4" id="text-3-1-4">
<ul class="org-ul">
<li><code>range(stop)</code></li>
<li><code>range(start, stop[, step])</code></li>
</ul>

<p>
Creating a matrix:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">newmat</span>=[[-1 <span class="org-keyword">for</span> x <span class="org-keyword">in</span> <span class="org-builtin">range</span>(height)] <span class="org-keyword">for</span> y <span class="org-keyword">in</span> <span class="org-builtin">range</span>(width)]
</pre>
</div>

<p>
list comprehension
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">even_squares</span> = [x**2 <span class="org-keyword">for</span> x <span class="org-keyword">in</span> l <span class="org-keyword">if</span> x%2 == 0]
</pre>
</div>
</div>
</div>


<div id="outline-container-org09602fe" class="outline-4">
<h4 id="org09602fe"><span class="section-number-4">3.1.5</span> Modify a list</h4>
<div class="outline-text-4" id="text-3-1-5">
<ul class="org-ul">
<li>list.append</li>
<li>list.pop</li>
</ul>
</div>
</div>

<div id="outline-container-orgb0fac36" class="outline-4">
<h4 id="orgb0fac36"><span class="section-number-4">3.1.6</span> List object model</h4>
<div class="outline-text-4" id="text-3-1-6">
<p>
Lists are mutable.  The behavior of slicing is a bit confusing. If the
slicing is used directly as the target of an assignment statement, it
will modify the object in place. E.g.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">a</span> = [1,2,3,4]
<span class="org-variable-name">a</span>[1:3] = []
a <span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; [1,4]</span>
</pre>
</div>

<p>
That also means all other references to <code>a</code> will be modified:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">a</span> = [1,2,3,4]
<span class="org-variable-name">a</span>[1:3] = []
<span class="org-comment-delimiter"># </span><span class="org-comment">although tuple is immutable, it can still contain reference to</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">mutable objects.</span>
<span class="org-variable-name">c</span>=(a,)
<span class="org-comment-delimiter"># </span><span class="org-comment">this will also modify a</span>
a.append(5)
c <span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; ([1,4,5])</span>
</pre>
</div>

<p>
However, if the slicing is assigned to another variable (either
assignment or pass-by-object function call), it is copied. Modifying
this copy will not affect the original list.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">a</span> = [1,2,3,4]
<span class="org-variable-name">b</span> = a[1:3]
<span class="org-variable-name">b</span>[0] = 9
a <span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; [1,2,3,4]</span>
<span class="org-keyword">def</span> <span class="org-function-name">foo</span>(x):
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">x</span>[1] = 8

<span class="org-comment-delimiter"># </span><span class="org-comment">changing b</span>
foo(b)
b <span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; [9,8]</span>
a <span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; [1,2,3,4]</span>
</pre>
</div>

<p>
If you convert a list to a tuple, the elements are shallow-copied.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">a</span> = [1,2,3]
<span class="org-variable-name">b</span> = [a]
<span class="org-comment-delimiter"># </span><span class="org-comment">this is shallow copied. Still contains reference to the object "a"</span>
<span class="org-variable-name">c</span> = <span class="org-builtin">tuple</span>(b)
<span class="org-comment-delimiter"># </span><span class="org-comment">no reference anymore, just a tuple of (1,2,3). Will never change</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">whatsoever.</span>
<span class="org-variable-name">d</span> = <span class="org-builtin">tuple</span>(a)

<span class="org-comment-delimiter"># </span><span class="org-comment">testing:</span>
<span class="org-variable-name">a</span>[2] = 8
b <span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; [[1,2,8]]</span>
c <span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; [[1,2,8]]</span>
d <span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; [1,2,3]</span>
</pre>
</div>

<p>
String is immutable sequence, thus cannot be assigned. Thus it is
fairly safe to use string.
</p>
</div>
</div>
</div>


<div id="outline-container-orga7f4df5" class="outline-3">
<h3 id="orga7f4df5"><span class="section-number-3">3.2</span> String</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-orge6d8f51" class="outline-4">
<h4 id="orge6d8f51"><span class="section-number-4">3.2.1</span> Concatenation</h4>
<div class="outline-text-4" id="text-3-2-1">
<ul class="org-ul">
<li>concatenate two strings directly by <code>+</code>.</li>
<li>need to convert integer to string before concatenate: <code>s + str(35)</code></li>
<li>"".join(lst) works</li>
</ul>
</div>
</div>

<div id="outline-container-orgc0da037" class="outline-4">
<h4 id="orgc0da037"><span class="section-number-4">3.2.2</span> split</h4>
<div class="outline-text-4" id="text-3-2-2">
<dl class="org-dl">
<dt><code>str.split(sep=None)</code></dt><dd>default by white space</dd>
<dt><code>str.strip()</code></dt><dd>strip out white space at both begin and end</dd>
<dt><code>str.replace(old, new)</code></dt><dd>replace <i>all</i>.</dd>
<dt><code>str.startswith(s)</code></dt><dd></dd>

<dt><code>str.endswith(s)</code></dt><dd></dd>
</dl>
</div>
</div>

<div id="outline-container-orga7a8713" class="outline-4">
<h4 id="orga7a8713"><span class="section-number-4">3.2.3</span> Slicing</h4>
<div class="outline-text-4" id="text-3-2-3">
<p>
String is an immutable object. It can use slicing. E.g. reversing a
string is as easy as <code>"hello"[::-1]</code>!
</p>

<p>
However, notice that when using a negative step, the slicing should be
<code>lst[end:begin:-1]</code>. This is because <code>x = i + n*k</code>:
</p>

<blockquote>
<p>
with a third “step” parameter: a[i:j:k] selects all items of a with
index x where x = i + n*k, n &gt;= 0 and i &lt;= x &lt; j.
</p>
</blockquote>

<p>
Also, the negative step does not always work as expect. E.g. the i
index is included and j is not; the j can not be negative, then how
can I include the first one in the list??
</p>

<p>
Thus if want to get a reverse of a sub-string, I would get sub-string
first and then reverse it.
</p>
</div>
</div>
</div>

<div id="outline-container-orgdc8e2b5" class="outline-3">
<h3 id="orgdc8e2b5"><span class="section-number-3">3.3</span> Dictionary</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Create:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">x</span> = {<span class="org-string">'a'</span>: 1, <span class="org-string">'b'</span>: 2}
</pre>
</div>
<p>
Dictionary is not sorted. Use <code>collections.OrderedDict</code> if you want this feature.
Basically it remember the order when the elements are inserted.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> collections
<span class="org-variable-name">od</span> = collections.OrderedDict(<span class="org-builtin">sorted</span>(d.items()))
</pre>
</div>

<p>
Merge two dictionary (<code>x</code> and <code>y</code>):
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">z</span> = x.copy()
z.update(y)
</pre>
</div>
</div>

<div id="outline-container-orgf5c3068" class="outline-4">
<h4 id="orgf5c3068"><span class="section-number-4">3.3.1</span> Set</h4>
<div class="outline-text-4" id="text-3-3-1">
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">s</span> = <span class="org-builtin">set</span>()
s.add(x)
<span class="org-keyword">if</span> x <span class="org-keyword">in</span> s:
<span class="org-highlight-indentation"> </span> <span class="org-keyword">pass</span>
</pre>
</div>
</div>
</div>
</div>
</div>




<div id="outline-container-org07a9e3a" class="outline-2">
<h2 id="org07a9e3a"><span class="section-number-2">4</span> Standard Library</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org0802d7b" class="outline-3">
<h3 id="org0802d7b"><span class="section-number-3">4.1</span> Operating System</h3>
<div class="outline-text-3" id="text-4-1">
</div>
<div id="outline-container-org752ce55" class="outline-4">
<h4 id="org752ce55"><span class="section-number-4">4.1.1</span> Env</h4>
<div class="outline-text-4" id="text-4-1-1">
<ul class="org-ul">
<li>os.environ['HOME']</li>
<li>os.getenv(name)</li>
<li>os.putenv(name, value)</li>
<li>os.unsetenv(name)</li>
</ul>
</div>
</div>

<div id="outline-container-org405a31a" class="outline-4">
<h4 id="org405a31a"><span class="section-number-4">4.1.2</span> Shell command</h4>
<div class="outline-text-4" id="text-4-1-2">
<dl class="org-dl">
<dt><code>os.system</code></dt><dd>simply run command</dd>
</dl>
<div class="org-src-container">
<pre class="src src-python">os.system(<span class="org-string">"some command"</span>)
</pre>
</div>

<dl class="org-dl">
<dt><code>os.popen</code></dt><dd>access to input output</dd>
</dl>
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">stream</span> = os.popen(<span class="org-string">"some command"</span>)
stream.read()
</pre>
</div>

<ul class="org-ul">
<li><code>subprocess.Popen</code></li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">p</span> = subprocess.Popen(<span class="org-string">"echo Hello World"</span>, shell=<span class="org-constant">True</span>, stdout=subprocess.PIPE)
p.stdout.read()
<span class="org-variable-name">s</span> = subprocess.check_output(<span class="org-string">'wc -l'</span>, stdin=p.stdout)
</pre>
</div>

<dl class="org-dl">
<dt><code>subprocess.call</code></dt><dd>this is the same as <code>subprocess.Popen</code> except that it waits and gives return code.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">return_code</span> = subprocess.call(<span class="org-string">"echo Hello World"</span>, shell=<span class="org-constant">True</span>, stdout=subprocess.DEVNULL)
</pre>
</div>
</div>
</div>
<div id="outline-container-orga85a2db" class="outline-4">
<h4 id="orga85a2db"><span class="section-number-4">4.1.3</span> Process</h4>
<div class="outline-text-4" id="text-4-1-3">
<ul class="org-ul">
<li>os.abort()</li>
<li>os.execl(path, arg0, arg1, &#x2026;)</li>
<li>os.execle(path, arg0, arg1, &#x2026;, env)</li>
<li>os.execlp(file, arg0, arg1, &#x2026;)</li>
<li>os.execlpe(file, arg0, arg1, &#x2026;, env)</li>
<li>os.execv(path, args)</li>
<li>os.execve(path, args, env)</li>
<li>os.execvp(file, args)</li>
<li>os.execvpe(file, args, env)</li>
<li>os.folk</li>
<li>os.wait()</li>
</ul>


<ul class="org-ul">
<li>os.system(cmd): run cmd, return exit code</li>
<li>os.times(): 5-tuple
<ul class="org-ul">
<li>user time</li>
<li>system time</li>
<li>childrens user time</li>
<li>childrens system time</li>
<li>elapsed real time</li>
</ul></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org67f30cd" class="outline-3">
<h3 id="org67f30cd"><span class="section-number-3">4.2</span> IO</h3>
<div class="outline-text-3" id="text-4-2">
</div>
<div id="outline-container-org516fa87" class="outline-4">
<h4 id="org516fa87"><span class="section-number-4">4.2.1</span> File IO</h4>
<div class="outline-text-4" id="text-4-2-1">
<p>
Reading:
</p>
<ul class="org-ul">
<li>read()</li>
<li>readline(size=1)</li>
<li>readlines()</li>
</ul>

<p>
Seeking:
</p>
<ul class="org-ul">
<li>seek(offset=0)
<ul class="org-ul">
<li>0 start</li>
<li>1 current</li>
<li>2 end</li>
</ul></li>
<li>tell(): current position</li>
</ul>

<p>
Writing:
</p>
<ul class="org-ul">
<li>write(s): finally the string!</li>
<li>writelines(lines): write a list of lines</li>
<li>flush()</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span class="org-highlight-indentation"> </span> <span class="org-variable-name">f</span> = <span class="org-builtin">open</span>(<span class="org-string">'text.txt'</span>)
<span class="org-highlight-indentation"> </span> f.read() <span class="org-comment-delimiter"># </span><span class="org-comment">return all content</span>

<span class="org-highlight-indentation"> </span> <span class="org-variable-name">f</span> = <span class="org-builtin">open</span>(<span class="org-string">'text.txt'</span>)
<span class="org-highlight-indentation"> </span> <span class="org-keyword">for</span> line <span class="org-keyword">in</span> f:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span> <span class="org-keyword">print</span>(line)

<span class="org-highlight-indentation"> </span> <span class="org-keyword">with</span> <span class="org-builtin">open</span>(<span class="org-string">'a.txt'</span>) <span class="org-keyword">as</span> f:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span> <span class="org-keyword">for</span> line <span class="org-keyword">in</span> f:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span> <span class="org-keyword">print</span>(line)
</pre>
</div>

<p>
Other IO:
</p>
<ul class="org-ul">
<li>f = io.StringIO("some string"): in memory text stream</li>
<li>f = io.BytesIO(b"some binary data \x00\x01")</li>
</ul>
</div>
</div>

<div id="outline-container-org34cc250" class="outline-4">
<h4 id="org34cc250"><span class="section-number-4">4.2.2</span> Printing</h4>
<div class="outline-text-4" id="text-4-2-2">
<ul class="org-ul">
<li>pprint.pprint(object, stream=None): pretty print</li>
<li>'string {0}, {hello}'.format('yes', hello=2)</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">print</span>(<span class="org-string">'xxx'</span>, end=<span class="org-string">''</span>)
</pre>
</div>

<p>
read from stdin:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">for</span> line <span class="org-keyword">in</span> sys.stdin:
<span class="org-highlight-indentation"> </span> <span class="org-keyword">print</span>(line)
</pre>
</div>
</div>
</div>

<div id="outline-container-org1ae6de4" class="outline-4">
<h4 id="org1ae6de4"><span class="section-number-4">4.2.3</span> redirect stdout</h4>
<div class="outline-text-4" id="text-4-2-3">
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> contextlib <span class="org-keyword">import</span> redirect_stdout
<span class="org-keyword">with</span> <span class="org-builtin">open</span>(<span class="org-string">'xxx.txt'</span>, <span class="org-string">'w'</span>) <span class="org-keyword">as</span> f:
<span class="org-highlight-indentation"> </span>   redirect_stdout(f)
</pre>
</div>

<p>
Or:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">sys.stdout</span> = f
</pre>
</div>

<p>
The file handle can be:
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">f</span> = <span class="org-builtin">open</span>(os.devnull, <span class="org-string">'w'</span>)
</pre>
</div>

<p>
It can also be a predefined handle, like <code>sys.stderr</code>:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">with</span> redirect_stdout(sys.stderr):
<span class="org-highlight-indentation"> </span>   <span class="org-builtin">help</span>(<span class="org-builtin">dir</span>)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orgeaaea94" class="outline-3">
<h3 id="orgeaaea94"><span class="section-number-3">4.3</span> File System</h3>
<div class="outline-text-3" id="text-4-3">
</div>
<div id="outline-container-org6ba95b0" class="outline-4">
<h4 id="org6ba95b0"><span class="section-number-4">4.3.1</span> os.walk</h4>
<div class="outline-text-4" id="text-4-3-1">
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> os
<span class="org-keyword">for</span> root,dirs,files <span class="org-keyword">in</span> os.walk(<span class="org-string">'.'</span>):
<span class="org-highlight-indentation"> </span> <span class="org-keyword">for</span> f <span class="org-keyword">in</span> files:
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">print</span> f
</pre>
</div>

<ul class="org-ul">
<li><code>os.path.abspath('relative/path/to/file')</code></li>
<li><code>os.path.exists("/path/to/file")</code></li>
<li><code>os.rename('old', 'new')</code></li>
<li><code>os.path.isfile</code></li>
</ul>
</div>
</div>

<div id="outline-container-org5dbd6c8" class="outline-4">
<h4 id="org5dbd6c8"><span class="section-number-4">4.3.2</span> FS Operations</h4>
<div class="outline-text-4" id="text-4-3-2">
<ul class="org-ul">
<li>os.getcwd(): current working directory</li>
<li>os.chdir(path): change cwd</li>
<li>os.mkdir(path)</li>
<li><code>os.listdir(path='.')</code>: list all in this dir. E.g. <code>for item in os.listdir('/path'): print (item)</code></li>
<li><code>os.makedirs(path)</code>: GOOD this is the way to go the make directories</li>
<li><code>os.remove(path)</code>: remove a file</li>
<li><code>os.rmdir()</code>: remove an empty dir.</li>
<li>os.removedirs(path): foo/bar/aaa will try to remove aaa, than bar,
then foo. Don't use! To recursively remove all contents, use
<code>shutil.rmtree</code></li>
<li>os.rename(src, dst)</li>
<li>os.renames(old, new)</li>
<li>os.rmdir(path): only work if dir is empty</li>
<li>os.tempnam(): a reasonable absolute name for creating temporary file
<ul class="org-ul">
<li>seems to be vulnerable</li>
</ul></li>
<li>os.walk(top, topdown=True): for each directory including top itself,
it yields 3-tuple (dirpath, dirnames, filenames). E.g. <code>for root,dirs,files in os.walk('/path'): for f in files: print (f);</code></li>
</ul>
</div>
</div>

<div id="outline-container-org80f5e75" class="outline-4">
<h4 id="org80f5e75"><span class="section-number-4">4.3.3</span> shutil</h4>
<div class="outline-text-4" id="text-4-3-3">
<ul class="org-ul">
<li>copy(src,dst)</li>
<li>copytree(src, dst): recursive</li>
<li>rmtree(path): rm -r</li>
<li>move(src, dst)</li>
</ul>

<p>
popen family is deprecated. Use subprocess.
</p>
</div>
</div>

<div id="outline-container-org0a0992a" class="outline-4">
<h4 id="org0a0992a"><span class="section-number-4">4.3.4</span> os.path</h4>
<div class="outline-text-4" id="text-4-3-4">
<p>
If parameter is not listed, it means a single path.
</p>

<ul class="org-ul">
<li><code>exists</code>: GOOD. check whether a path exists</li>
<li><code>split</code>: return a pair (head, tail). tail is the last component,
without slash. If path ends with slash, tail is empty
<ul class="org-ul">
<li><code>basename</code>: the tail of the split output</li>
<li><code>dirname</code>: head of split output</li>
</ul></li>
<li><code>normpath</code>: collapse redundant separators and up level references</li>
<li><code>abspath</code>: from relative to absolute
path. normpath(join(os.getcwd(), path))</li>
<li><code>commonprefix(list)</code>: return the longest path prefix</li>
<li><code>expanduser</code>: replace the initial component of ~ by the users directory.</li>
<li><code>getsize</code>: in bytes</li>
<li><code>isabs</code>: predicate for absolute</li>
<li><code>isfile</code>:</li>
<li><code>isdir</code></li>
<li><code>islink</code></li>
<li><code>join(path, *paths)</code>: join intelligently</li>
<li><code>realpath</code>: canonical path by following symbolic links</li>
</ul>
</div>
</div>

<div id="outline-container-orge15c130" class="outline-4">
<h4 id="orge15c130"><span class="section-number-4">4.3.5</span> pathlib</h4>
<div class="outline-text-4" id="text-4-3-5">
<p>
Object-oriented filesystem paths.
<a href="https://docs.python.org/3/library/pathlib.html">https://docs.python.org/3/library/pathlib.html</a>
</p>

<p>
<code>pathlib.Path</code> is the class.  <code>pathlib.PosixPath</code> is a subclass for
non-windows paths, but seems just for implementation purpose, makes no
contribution for user.
</p>



<p>
Actually not very interesting, this table tells everything:
</p>

<table border="2" cellspacing="2" cellpadding="6" rules="groups" frame="border">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">os and os.path</th>
<th scope="col" class="org-left">pathlib</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">os.path.abspath()</td>
<td class="org-left">Path.resolve()</td>
</tr>

<tr>
<td class="org-left">os.chmod()</td>
<td class="org-left">Path.chmod()</td>
</tr>

<tr>
<td class="org-left">os.mkdir()</td>
<td class="org-left">Path.mkdir()</td>
</tr>

<tr>
<td class="org-left">os.rename()</td>
<td class="org-left">Path.rename()</td>
</tr>

<tr>
<td class="org-left">os.replace()</td>
<td class="org-left">Path.replace()</td>
</tr>

<tr>
<td class="org-left">os.rmdir()</td>
<td class="org-left">Path.rmdir()</td>
</tr>

<tr>
<td class="org-left">os.remove() , os.unlink()</td>
<td class="org-left">Path.unlink()</td>
</tr>

<tr>
<td class="org-left">os.getcwd()</td>
<td class="org-left">Path.cwd()</td>
</tr>

<tr>
<td class="org-left">os.path.exists()</td>
<td class="org-left">Path.exists()</td>
</tr>

<tr>
<td class="org-left">os.path.expanduser()</td>
<td class="org-left">Path.expanduser() and Path.home()</td>
</tr>

<tr>
<td class="org-left">os.path.isdir()</td>
<td class="org-left">Path.is<sub>dir</sub>()</td>
</tr>

<tr>
<td class="org-left">os.path.isfile()</td>
<td class="org-left">Path.is<sub>file</sub>()</td>
</tr>

<tr>
<td class="org-left">os.path.islink()</td>
<td class="org-left">Path.is<sub>symlink</sub>()</td>
</tr>

<tr>
<td class="org-left">os.stat()</td>
<td class="org-left">Path.stat(), Path.owner(), Path.group()</td>
</tr>

<tr>
<td class="org-left">os.path.isabs()</td>
<td class="org-left">PurePath.is<sub>absolute</sub>()</td>
</tr>

<tr>
<td class="org-left">os.path.join()</td>
<td class="org-left">PurePath.joinpath()</td>
</tr>

<tr>
<td class="org-left">os.path.basename()</td>
<td class="org-left">PurePath.name</td>
</tr>

<tr>
<td class="org-left">os.path.dirname()</td>
<td class="org-left">PurePath.parent</td>
</tr>

<tr>
<td class="org-left">os.path.samefile()</td>
<td class="org-left">Path.samefile()</td>
</tr>

<tr>
<td class="org-left">os.path.splitext()</td>
<td class="org-left">PurePath.suffix</td>
</tr>
</tbody>
</table>


<p>
Some interesting APIs that don't have counterparts:
</p>
<ul class="org-ul">
<li><code>Path.glob(pattern)</code> that returns a list of all files matching the
shell pattern, e.g. <code>p.glob('*/*.py')</code></li>
<li>slash operator: you can directly use <code>p / 'foo' / 'bar'</code></li>
<li><code>Path.iterdir()</code> gives a list of directory items</li>
<li><code>Path.parts</code> gives a list of string</li>
</ul>
</div>
</div>

<div id="outline-container-org67beb3e" class="outline-4">
<h4 id="org67beb3e"><span class="section-number-4">4.3.6</span> <span class="todo TODO">TODO</span> tempfile</h4>
<div class="outline-text-4" id="text-4-3-6">
<ul class="org-ul">
<li><code>mkstemp</code> creates temp file, but this file is opened. The return value is the
file descriptor (int) of the opened file, the same as that gets returned by
<code>os.open</code>, thus not easy to work with</li>
<li><code>mkdtemp</code> creates temp dir. I would just use this when creating temporary files.</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">folder</span> = tempfile.mkdtemp()
<span class="org-variable-name">fd</span>, <span class="org-variable-name">fname</span> = tempfile.mkstemp()
</pre>
</div>
</div>
</div>
</div>




<div id="outline-container-orgd4cb2cc" class="outline-3">
<h3 id="orgd4cb2cc"><span class="section-number-3">4.4</span> unittest</h3>
<div class="outline-text-3" id="text-4-4">
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">class</span> <span class="org-type">MyTest</span>(unittest.TestCase):
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">def</span> <span class="org-function-name">test_me</span>(<span class="org-keyword">self</span>):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">self</span>.assertEqual(1,2)
unittest.main()
</pre>
</div>

<p>
python unit test can support automatic test discovery. To use that,
the file must be named <code>test_xxx.py</code>, and run the <code>python -m unittest discover</code>.
</p>
</div>
</div>

<div id="outline-container-org05942f1" class="outline-3">
<h3 id="org05942f1"><span class="section-number-3">4.5</span> time</h3>
<div class="outline-text-3" id="text-4-5">
<p>
Create time object:
</p>
<ul class="org-ul">
<li>time.sleep(secs)</li>
<li>time.time(): time in seconds since epoch</li>
<li>gmtime(): in seconds, from epoch</li>
<li>localtime(): convert gmtime() to local</li>
<li>clock(): processor time as floating number in seconds</li>
</ul>

<p>
The returned time object is <code>class time.struct_time</code>: returned by gmtime(),
localtime() and strptime().  Time to format string:
</p>

<ul class="org-ul">
<li>strptime(string[, format]): parse a string into time object
<ul class="org-ul">
<li>format default: "%a %b %d %H:%M:%S %Y"</li>
<li>time.strptime("30 Nov 00", "%d %b %y")</li>
</ul></li>
<li>strftime(format[, t]): convert from time object to string
<ul class="org-ul">
<li>%a/A: abbr/full weekday name</li>
<li>%b/B: abbr/full month name</li>
<li>%Y: year</li>
<li>%m: month [01,12]</li>
<li>%d: day of the month [01,31]</li>
<li>%H: 24-hour [00,23]</li>
<li>%I: 12-hour [01,12]</li>
<li>%p: AM or PM</li>
<li>%M: Minute [00,59]</li>
<li>%S: second [00,61]</li>
</ul></li>
</ul>
</div>

<div id="outline-container-orgf3b1238" class="outline-4">
<h4 id="orgf3b1238"><span class="section-number-4">4.5.1</span> datetime</h4>
<div class="outline-text-4" id="text-4-5-1">
<ul class="org-ul">
<li><code>date</code> has year, month, day</li>
<li><code>time</code> has hour, minute, second</li>
<li><code>datetime</code> has both</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> datetime

<span class="org-variable-name">t1</span> = datetime.date.fromisoformat(<span class="org-string">'2019-12-04'</span>)
<span class="org-variable-name">t2</span> = datetime.date.fromisoformat(<span class="org-string">'2018-11-24'</span>)

<span class="org-variable-name">delta</span> = t1 - t2
delta.days

<span class="org-variable-name">t3</span> = datetime.date.today()
<span class="org-variable-name">t4</span> = datetime.date.date(2019, 12, 20)

<span class="org-variable-name">t0</span> = datetime.date.fromtimestamp(time.time())
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb5f46d3" class="outline-3">
<h3 id="orgb5f46d3"><span class="section-number-3">4.6</span> csv</h3>
<div class="outline-text-3" id="text-4-6">
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> csv
<span class="org-keyword">with</span> <span class="org-builtin">open</span>(<span class="org-string">'some.csv'</span>, newline=<span class="org-string">''</span>) <span class="org-keyword">as</span> f:
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">reader</span> = csv.reader(f)
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> row <span class="org-keyword">in</span> reader:
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-keyword">print</span>(row)

<span class="org-keyword">import</span> csv
<span class="org-keyword">with</span> <span class="org-builtin">open</span>(<span class="org-string">'some.csv'</span>, <span class="org-string">'w'</span>, newline=<span class="org-string">''</span>) <span class="org-keyword">as</span> f:
<span class="org-highlight-indentation"> </span>   <span class="org-variable-name">writer</span> = csv.writer(f)
<span class="org-highlight-indentation"> </span>   writer.writerow(row)
<span class="org-highlight-indentation"> </span>   writer.writerows(someiterable)
</pre>
</div>
</div>
</div>

<div id="outline-container-org12bca49" class="outline-3">
<h3 id="org12bca49"><span class="section-number-3">4.7</span> Json</h3>
<div class="outline-text-3" id="text-4-7">
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> json
json.dumps({<span class="org-string">"C"</span>: 0, <span class="org-string">"D"</span>: 1})
json.loads(<span class="org-string">"a string of json"</span>)

json.dump(obj, fp, indent=2)
json.load(fp)
</pre>
</div>
</div>
</div>

<div id="outline-container-org9c9b9d7" class="outline-3">
<h3 id="org9c9b9d7"><span class="section-number-3">4.8</span> argparse</h3>
<div class="outline-text-3" id="text-4-8">
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> argparse
<span class="org-variable-name">parser</span> = argparse.ArgumentParser(descripton=<span class="org-string">'Description here'</span>)

parser.add_argument(<span class="org-string">'-q'</span>, <span class="org-string">'--query'</span>, <span class="org-builtin">help</span>=<span class="org-string">'query github api'</span>, require=<span class="org-constant">True</span>)
parser.add_argument(<span class="org-string">'-d'</span>, <span class="org-string">'--download'</span>, <span class="org-builtin">help</span>=<span class="org-string">'do download'</span>, action=<span class="org-string">'store_true'</span>)

<span class="org-variable-name">args</span> = parser.parse_args()
</pre>
</div>

<p>
The most interesting method is of course the <code>add_argument</code>. It
accepts the name, either a single string, <code>bar</code>, indicating positional
argument, or a string starting with <code>-</code>, indicating optional
arguments. You can supply <code>parser.add_argument(-f, --foo)</code> for short
and full argument. The value is stored as an attribute with the same
name (i.e. <code>bar</code>, <code>foo</code>) of the result, but you can change it to
anther name via <code>dest</code> argument.
</p>

<p>
An <i>action</i> defines what to do with the argument. It is a string
(!!!). The default is <code>'store'</code>, meaning store the supplied value to
the result. If you don't need the value, but just want to know if the
option is supplied, use <code>store_true</code> or <code>store_false</code>, which differ
only in default value. The action <code>append</code> will collect each
occurrence of the argument into a list.
</p>

<p>
By default, each option consume one argument. You can change this by
the argument <code>nargs</code>. If it is an integer, it means how many should be
consumed. The result will be a list, thus in case of <code>1</code>, it is still
different from default. It can be a string <code>'*', '+', '?'</code>, which
conforms to the regular expression meaning of them. <code>*</code> and <code>+</code>
produce a list, <code>+</code> will get give error when no arguments are
provided, <code>?</code> will use <code>default</code> if missing.
</p>

<p>
In case of missing value, the <code>default</code> argument can be used to supply
the default value. Otherwise, it is none. You can also use <code>required</code>
argument to make sure user supplies something. A value is by default a
string, you can convert it to anther data type by the <code>type</code> option,
accepting a data type, e.g. <code>int</code>. You might also want to restrict the
choices of the argument, so <code>choices</code> is a list of allowed values.
</p>


<p>
Finally, <code>help</code> option can be used to provide help string, and it can
be printed out using <code>parser.print_help()</code>.  To test the parser, you
can use <code>parser.parse_args(['-f', '1', 'bar'])</code>.
</p>
</div>
</div>


<div id="outline-container-org1f1ffcd" class="outline-3">
<h3 id="org1f1ffcd"><span class="section-number-3">4.9</span> Regular Expression</h3>
<div class="outline-text-3" id="text-4-9">
<p>
construction
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> re
<span class="org-variable-name">pattern</span> = re.<span class="org-builtin">compile</span>(<span class="org-string">'\d+.*$'</span>)
</pre>
</div>

<p>
match
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">s</span> = <span class="org-string">'this is a test string'</span>
pattern.match(s) <span class="org-comment-delimiter"># </span><span class="org-comment">return True or False</span>

</pre>
</div>

<p>
search
</p>
<div class="org-src-container">
<pre class="src src-python">pattern.findall(s)
</pre>
</div>

<p>
shorthand
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">m</span> = re.match(<span class="org-string">"[pattern]"</span>, <span class="org-string">"string"</span>)
m.group()
<span class="org-variable-name">m</span> = re.search(<span class="org-string">"[pattern]"</span>, <span class="org-string">"string"</span>)
m.group()
re.search(<span class="org-string">"pattern"</span>, <span class="org-string">"string"</span>, re.IGNORECASE)
<span class="org-variable-name">m</span> = re.findall(<span class="org-string">"[pattern]"</span>, <span class="org-string">"string"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org1b06186" class="outline-3">
<h3 id="org1b06186"><span class="section-number-3">4.10</span> Concurrent programming</h3>
<div class="outline-text-3" id="text-4-10">
</div>
<div id="outline-container-org79936b4" class="outline-4">
<h4 id="org79936b4"><span class="section-number-4">4.10.1</span> threading</h4>
<div class="outline-text-4" id="text-4-10-1">
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> threading <span class="org-keyword">import</span> Thread

<span class="org-keyword">class</span> <span class="org-type">MyThread</span>(Thread):
<span class="org-highlight-indentation"> </span> <span class="org-keyword">def</span> <span class="org-function-name">__init__</span>(<span class="org-keyword">self</span>, arg):
<span class="org-highlight-indentation"> </span>   Thread.__init__(<span class="org-keyword">self</span>)
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">self</span>.arg = arg
<span class="org-highlight-indentation"> </span> <span class="org-keyword">def</span> <span class="org-function-name">run</span>(<span class="org-keyword">self</span>):
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">pass</span>

<span class="org-variable-name">t</span> = MyThread(arg)
t.start()
</pre>
</div>


<p>
The package name is <code>threading</code>, the object is <code>Thread</code>.
</p>

<p>
Functions
</p>
<ul class="org-ul">
<li>threading.active<sub>count</sub>(): number of Thread object</li>
<li>threading.current<sub>thread</sub>(): current Thread object</li>
<li>threading.enumerate(): return a list of all Thread objects</li>
<li>threading.meain(): the main Thread object</li>
<li>threading.local(): the instance of local storage. Different for
different threads. Typical usage: <code>mydata = threading.local()</code></li>
</ul>

<p>
Two ways to specify what to run:
</p>
<ul class="org-ul">
<li>pass a callable object to the <code>target</code> argument when constructing Thread</li>
<li>define a subclass of Thread and override the <code>run</code> method.</li>
</ul>

<p>
Methods:
</p>
<ul class="org-ul">
<li><code>start</code>: start the thread. It will call <code>run</code> method in a separate
thread. The thread terminate when <code>run</code> terminate</li>
<li><code>join(timeout=None)</code>: the calling thread will block until this thread terminate
<ul class="org-ul">
<li>timeout should be float in seconds</li>
</ul></li>
<li><code>is_alive</code>: test whether the thread terminate</li>
</ul>
</div>
</div>

<div id="outline-container-orga975ab0" class="outline-4">
<h4 id="orga975ab0"><span class="section-number-4">4.10.2</span> Thread Sync</h4>
<div class="outline-text-4" id="text-4-10-2">
<p>
class threading.Lock
</p>
<ul class="org-ul">
<li>acquire()</li>
<li>release()</li>
</ul>

<p>
class threading.RLock
</p>
<ul class="org-ul">
<li>this is recursive lock. The same thread can acquire the lock
multiple times. They will be nested and only when the last release
is called, the lock can be acquired by another thead</li>
<li>acquire()</li>
<li>release()</li>
</ul>


<p>
class threading.Condition(lock=None)
</p>
<ul class="org-ul">
<li>the lock must be a Lock or RLock. If none, a RLock is created</li>
<li>acquire()</li>
<li>release()</li>
<li>wait(timeout=None): wait until notified
<ul class="org-ul">
<li>release underlying lock</li>
<li>block until notify</li>
<li>re-acquire the lock and return</li>
<li>typical usage: <code>while not item_is_available(): cv.wait()</code></li>
<li>often use <code>with</code> statement: =with cv: cv.wait<sub>for</sub>(pred); get();</li>
</ul></li>
<li>wait<sub>for</sub>(predicate, timeout=None)
<ul class="org-ul">
<li>this is same as <code>while not predicate(): cv.wait()</code>, thus more
convenient than <code>wait</code></li>
</ul></li>
<li>notify(n=1): notify one thread</li>
<li>notify<sub>all</sub>(): notify all threads waiting on this condition</li>
</ul>

<p>
class threading.Semaphore: this class manage resources with limited capacity.
</p>
<ul class="org-ul">
<li>acquire(): decrease capacity</li>
<li>release(): increase capacity</li>
</ul>

<p>
class threading.Event
</p>
<ul class="org-ul">
<li>is<sub>set</sub>():</li>
<li>set(): set flag to true</li>
<li>clear(): set flag to false</li>
<li>wait(timeout=None): block until internal flag is true</li>
</ul>

<p>
class threading.Timer(interval, function) : Thread
</p>
<ul class="org-ul">
<li>interval is float in seconds, function is callable. use <code>start</code>
method to start the thread, and the function will be called after
the delay.</li>
<li>cancel(): stop the timer and cancel the execution. Only work if the
the timer is still waiting.</li>
</ul>

<p>
class threading.Barrier(parties, action=None, timeout=None)
</p>
<ul class="org-ul">
<li>parties is integer. Every thread calling wait will block, until
<i>parties</i> number of such call is called. Then all players unblock
and do things simultaneously.</li>
<li>wait(timeout=None)</li>
<li>reset(): reset the barrier. The thread waiting for it will receive <code>BrokenBarrierError</code></li>
<li>abort(): all current and <i>future</i> wait call for it will get <code>BrokenBarrierError</code></li>
<li>parties: number of parties</li>
<li>n<sub>waiting</sub>: number of current waiting</li>
<li>broken: True or False</li>
</ul>
</div>

<div id="outline-container-org4bfce27" class="outline-5">
<h5 id="org4bfce27"><span class="section-number-5">4.10.2.1</span> Using with statement</h5>
<div class="outline-text-5" id="text-4-10-2-1">
<p>
Lock, RLock, Condition, Semaphore can be used.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">with</span> somelock:
<span class="org-highlight-indentation"> </span> <span class="org-comment-delimiter"># </span><span class="org-comment">do somthing</span>
</pre>
</div>

<p>
is equivalent to:
</p>
<div class="org-src-container">
<pre class="src src-python">somelock.acquire()
<span class="org-keyword">try</span>:
<span class="org-highlight-indentation"> </span> <span class="org-comment-delimiter"># </span><span class="org-comment">do something</span>
<span class="org-keyword">finally</span>:
<span class="org-highlight-indentation"> </span> somelock.release()
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge3a65e4" class="outline-4">
<h4 id="orge3a65e4"><span class="section-number-4">4.10.3</span> multiprocessing</h4>
<div class="outline-text-4" id="text-4-10-3">
<p>
This provide multiprocessing.Process class, having similar API with
Thread.  It seems to use fork but don't have explicit exec on the
document?? Wired and seems just do something thread can do (except the
sharing of memory of course).
</p>
</div>
</div>

<div id="outline-container-org072564c" class="outline-4">
<h4 id="org072564c"><span class="section-number-4">4.10.4</span> subprocess</h4>
<div class="outline-text-4" id="text-4-10-4">
<ul class="org-ul">
<li>subprocess.run(args, *, stdin=None, input=None, stdout=None,
stderr=None, shell=False, timeout=None, check=False)
<ul class="org-ul">
<li>run the command and wait for it to complete. Return a
<code>CompleteProcess</code> instance.</li>
<li>if check is True, raise CalledProcessError exception if return
code non-zero. This replace the check<sub>call</sub> and check<sub>output</sub>.</li>
</ul></li>
</ul>

<p>
class subprocess.CompletedProcess
</p>
<ul class="org-ul">
<li>args</li>
<li>returncode</li>
<li>stdout: captured if PIPE is passed to stdout</li>
<li>stderr: captured if PIPE is passed to stderr</li>
<li>check<sub>returncode</sub>(): if returncode is non-zero, raise CalledProcessError</li>
</ul>

<p>
Variables:
</p>
<ul class="org-ul">
<li>subprocess.DEVNULL</li>
<li>subprocess.PIPE</li>
<li>subprocess.STDOUT: this is only used in the place of stderr to redirect it to stdout</li>
</ul>

<p>
class subprocess.CalledProcessError
</p>
<ul class="org-ul">
<li>returncode</li>
<li>cmd</li>
<li>output: same as stdout</li>
<li>stdout</li>
<li>stderr</li>
</ul>

<p>
The followings are from 2.7, now only use run.
</p>
<ul class="org-ul">
<li>subprocess.call(args, *, stdin=None, stdout=None, stderr=None, shell=False)
<ul class="org-ul">
<li>args: a list of argument, including arg0</li>
<li>it can also be a string due to that *</li>
<li>it will wait, then return returncode</li>
<li>do not use stdout=PIPE, use communicate() instead TODO</li>
<li>use shell=True is bad, but it can give me
<ul class="org-ul">
<li>shell pipes</li>
<li>filename wildcard</li>
<li>env variable expansion</li>
<li>~ expansion</li>
</ul></li>
</ul></li>
<li>check<sub>call</sub>(args, *, &#x2026;): same as call, except it will raise exception if return non-0</li>
<li>check<sub>output</sub>(args, *, stdin=None, stderr=None, shell=False, universal<sub>newlines</sub>=False)
<ul class="org-ul">
<li>if return non-0, raise exception. Otherwise return the stdout</li>
</ul></li>
</ul>

<p>
Popen object
</p>
<ul class="org-ul">
<li>Popen constructor
<ul class="org-ul">
<li>args, bufsize=0, executable=None,</li>
<li>stdin=None, stdout=None, stderr=None,</li>
<li>preexec<sub>fn</sub>=None, close<sub>fds</sub>=False,</li>
<li>shell=False, cwd=None, env=None,</li>
<li>universal<sub>newlines</sub>=False, startupinfo=None, creationflags=0</li>
</ul></li>
<li>Popen.poll(): check if child process has terminated. Set and return
returncode.</li>
<li>Popen.wait(): wait for process to terminate. Don't use PIPE with this.</li>
<li>Popen.communicate(input=None): to use this, the corresponding stdin,
stdout, stderr should be set to PIPE.
<ul class="org-ul">
<li>send data to stdin (string)</li>
<li>read data from stdout and stderr (it returns a tuple (out, err))</li>
<li>wait for termination</li>
</ul></li>
<li>Popen.sned<sub>signal</sub>(signal)</li>
<li>Popen.terminate(): send SIGTERM</li>
<li>Popen.kill(): send SIGKILL</li>
<li>Popen.pid</li>
<li>Popen.returncode
<ul class="org-ul">
<li>set by poll and wait (and indirectly by communicate)</li>
<li>None indicate hasn't terminated</li>
<li>-N means terminated by signal N</li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>




<div id="outline-container-orgd1cac5f" class="outline-2">
<h2 id="orgd1cac5f"><span class="section-number-2">5</span> Third party libraries</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orgc871cc2" class="outline-3">
<h3 id="orgc871cc2"><span class="section-number-3">5.1</span> urllib</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> urllib <span class="org-keyword">import</span> request
<span class="org-keyword">import</span> json

<span class="org-variable-name">url</span> = <span class="org-string">'https://api.github.com'</span>
<span class="org-variable-name">api</span> = <span class="org-string">'/search/repositories'</span>
<span class="org-variable-name">query</span> = <span class="org-string">'language:C&amp;stars:&gt;10&amp;per_page='</span>+size
<span class="org-variable-name">response</span> = request.urlopen(url+api+<span class="org-string">"?q="</span>+query)

<span class="org-variable-name">s</span> = response.read().decode(<span class="org-string">'utf8'</span>)
<span class="org-variable-name">j</span> = json.loads(s)
<span class="org-comment-delimiter"># </span><span class="org-comment">j will be a mix of list and dict</span>
</pre>
</div>
</div>

<div id="outline-container-org0e1693b" class="outline-4">
<h4 id="org0e1693b"><span class="section-number-4">5.1.1</span> urllib.request</h4>
<div class="outline-text-4" id="text-5-1-1">
<p>
package urllib.request
</p>

<p>
Functions
</p>
<ul class="org-ul">
<li>urlopen(url, data=None)
<ul class="org-ul">
<li>url can be a string or Request object</li>
<li>for http and https, returns a http.client.HTTPResponse object</li>
<li>for FTP, file, data urls, return a urllib.response.addinfourl object</li>
</ul></li>
<li>pathname2url(path): do quoting</li>
<li>url2pathname(path): do unquoting</li>
</ul>

<p>
class Request
</p>
<ul class="org-ul">
<li>constructor: (url, data=None, headers={}, method=None)
<ul class="org-ul">
<li>url: a string</li>
<li>headers: a dictionary.</li>
<li>method: a string. 'GET' is default. Available values: 'HEAD', 'POST'</li>
</ul></li>
</ul>
<p>
methods:
</p>
<ul class="org-ul">
<li>get<sub>method</sub>()</li>
<li>add<sub>header</sub>(key, val)</li>
<li>has<sub>header</sub>(key)</li>
<li>get<sub>header</sub>(key)</li>
<li>remove<sub>header</sub>(key)</li>
<li>get<sub>full</sub><sub>url</sub>()</li>
<li>header<sub>items</sub>(): return a list of tuples (key, value)</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span class="org-highlight-indentation"> </span> <span class="org-variable-name">req</span> = request.Request(query)
<span class="org-highlight-indentation"> </span> req.add_header(<span class="org-string">"Authorization"</span>, <span class="org-string">"token "</span> + token)
<span class="org-highlight-indentation"> </span> <span class="org-variable-name">response</span> = request.urlopen(req)
<span class="org-highlight-indentation"> </span> <span class="org-variable-name">s</span> = response.read().decode(<span class="org-string">'utf8'</span>)
<span class="org-highlight-indentation"> </span> <span class="org-variable-name">langj</span> = json.loads(s);
<span class="org-highlight-indentation"> </span> <span class="org-comment-delimiter"># </span><span class="org-comment">deprecated</span>
<span class="org-highlight-indentation"> </span> urllib.request.urlretrieve(url[, filename])
</pre>
</div>
</div>
</div>

<div id="outline-container-orgce7ccce" class="outline-4">
<h4 id="orgce7ccce"><span class="section-number-4">5.1.2</span> urllib.parse</h4>
<div class="outline-text-4" id="text-5-1-2">
<ul class="org-ul">
<li>quote(string)</li>
<li>quote<sub>plus</sub>(string)</li>
<li>unquote(string)</li>
<li>unquote<sub>plus</sub>(string)</li>
<li>urlencode(query)</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-orgbe56383" class="outline-3">
<h3 id="orgbe56383"><span class="section-number-3">5.2</span> XML</h3>
<div class="outline-text-3" id="text-5-2">
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> xml.etree.ElementTree <span class="org-keyword">as</span> ET
<span class="org-variable-name">root</span> = ET.fromstring(s)
<span class="org-comment-delimiter"># </span><span class="org-comment">XPath</span>
<span class="org-variable-name">nodes</span> = root.findall(<span class="org-string">'{http://www.sdml.info/srcML/src}function'</span>)
<span class="org-keyword">for</span> node <span class="org-keyword">in</span> nodes:
<span class="org-highlight-indentation"> </span> <span class="org-comment-delimiter"># </span><span class="org-comment">do with node</span>
<span class="org-highlight-indentation"> </span> <span class="org-keyword">pass</span>
</pre>
</div>

<p>
APIs
</p>
<ul class="org-ul">
<li><code>node.find(XPath)</code></li>
<li><code>node.findall(XPath)</code></li>
<li><code>node.get(Attribute)</code></li>
<li><code>node.text</code></li>
</ul>
</div>
</div>
<div id="outline-container-orgef30665" class="outline-3">
<h3 id="orgef30665"><span class="section-number-3">5.3</span> Requests</h3>
<div class="outline-text-3" id="text-5-3">
<p>
<a href="http://docs.python-requests.org/en/master/">http://docs.python-requests.org/en/master/</a>
</p>
</div>
</div>

<div id="outline-container-org5d4f44c" class="outline-3">
<h3 id="org5d4f44c"><span class="section-number-3">5.4</span> BeautifulSoup</h3>
<div class="outline-text-3" id="text-5-4">
<p>
The package is called <code>BeautifulSoup4</code>.
</p>

<p>
The preface to use the package:
</p>


<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> bs4 <span class="org-keyword">import</span> BeautifulSoup
BeautifulSoup(<span class="org-string">'&lt;html&gt;string&lt;/html&gt;'</span>)
<span class="org-keyword">with</span> <span class="org-builtin">open</span>(<span class="org-string">'a.html'</span>) <span class="org-keyword">as</span> fp:
<span class="org-highlight-indentation"> </span>   BeautifulSoup(fp)
</pre>
</div>


<p>
Each node can be used as a data structure, with the following fields:
</p>
<ul class="org-ul">
<li><code>name</code>: the tag name</li>
<li><code>string</code>: the (first?) string directly embedded inside the node</li>
<li><code>strings</code>: a list of the strings</li>
<li><code>a-tag</code>: the first child that is of that tag</li>
<li><code>attrs</code>: a list of all attribute names</li>
<li><code>children</code>: going downwards</li>
<li><code>descendants</code>: intuitive</li>
<li><code>parent</code></li>
<li><code>parents</code>: wow, this should be called ancestor?</li>
<li><code>next_sibling</code>, <code>previous_sibling</code></li>
</ul>


<p>
It can also be used as a dictionary of its attributes,
e.g. <code>s['href']</code>. This should be a string. It is equivalent to using
the <code>get</code> method with the class name.
</p>

<p>
Several methods are of particular interests.
</p>
<ul class="org-ul">
<li><code>get_text()</code>: return all text in the node</li>
</ul>

<p>
You can also execute a query on it. In general, <code>find_all</code> returns a
list, while <code>find</code> returns the first one. There are also some methods
in this family, namely <code>find_next_siblings</code>, <code>find_parents</code>. E.g.
</p>
<ul class="org-ul">
<li><code>s.find_all('a')</code>: return a list of all 'a' tag nodes</li>
</ul>

<p>
Or it can be a query respecting css id and classes. Although <code>find</code>
has some support for id and class, the <code>select</code> is easier to use.
</p>
<ul class="org-ul">
<li><code>s.select("body a")</code>: non-direct</li>
<li><code>s.select("p &gt; a")</code>: direct</li>
<li><code>s.select(p.c#id)</code>: class and id</li>
<li><code>s.select(p &gt; #id)</code>: mix</li>
<li><code>s.select(a[href^=xxx])</code>: filtering based on attribute values</li>
</ul>
</div>
</div>



<div id="outline-container-org058f4a1" class="outline-3">
<h3 id="org058f4a1"><span class="section-number-3">5.5</span> click <a href="http://click.pocoo.org/5/">http://click.pocoo.org/5/</a></h3>
</div>

<div id="outline-container-orge09c442" class="outline-3">
<h3 id="orge09c442"><span class="section-number-3">5.6</span> pandas</h3>
<div class="outline-text-3" id="text-5-6">
<p>
Looks like it is a dataframe library
</p>
</div>
</div>

<div id="outline-container-org659e007" class="outline-3">
<h3 id="org659e007"><span class="section-number-3">5.7</span> numpy</h3>
<div class="outline-text-3" id="text-5-7">
<p>
C-implementation of multi-dimensional arrays
</p>
</div>
</div>

<div id="outline-container-org9ce2f52" class="outline-3">
<h3 id="org9ce2f52"><span class="section-number-3">5.8</span> scipy</h3>
<div class="outline-text-3" id="text-5-8">
<p>
scitific computing algorithms, including:
</p>

<ul class="org-ul">
<li>linaer algebra</li>
<li>optimization</li>
<li>interpolation</li>
<li>integration and differential equation</li>
<li>clustering algorithms</li>
<li>statistical distributions</li>
</ul>
</div>
</div>

<div id="outline-container-org1aca3d9" class="outline-3">
<h3 id="org1aca3d9"><span class="section-number-3">5.9</span> scikit-learn</h3>
<div class="outline-text-3" id="text-5-9">
<p>
Learning library.
</p>
<ul class="org-ul">
<li><a href="https://scikit-learn.org/stable/index.html">website</a></li>
<li><a href="https://scikit-learn.org/stable/user_guide.html">user guide</a></li>
</ul>

<p>
Supervised learning:
</p>
<ul class="org-ul">
<li>linear models</li>
<li>SVM</li>
<li>Gaussian Processes</li>
<li>Naive Bayes</li>
<li>Decision Trees</li>
<li>KNN</li>
</ul>


<p>
Unsupervised learning:
</p>
<ul class="org-ul">
<li>Gaussian Mixture Models</li>
<li>Manifold learning</li>
<li>clustering
<ul class="org-ul">
<li>k-means</li>
</ul></li>
</ul>


<p>
Other topics
</p>
<ul class="org-ul">
<li>Ensemble methods</li>
<li>Feature Selection</li>
<li>Outlier detection</li>
<li>model selection
<ul class="org-ul">
<li>grid search</li>
<li>cross validation</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org22bd492" class="outline-3">
<h3 id="org22bd492"><span class="section-number-3">5.10</span> matplotlib</h3>
<div class="outline-text-3" id="text-5-10">
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> matplotlib.pyplot <span class="org-keyword">as</span> plt
</pre>
</div>

<p>
Reference
</p>
<ul class="org-ul">
<li><a href="https://matplotlib.org/gallery/index.html">gallery</a></li>
<li><a href="https://matplotlib.org/tutorials/index.html">tutorials</a></li>
<li><a href="https://matplotlib.org/api/pyplot_summary.html">pyplot API</a></li>
</ul>
</div>

<div id="outline-container-orgff4598a" class="outline-4">
<h4 id="orgff4598a"><span class="section-number-4">5.10.1</span> type of figures</h4>
<div class="outline-text-4" id="text-5-10-1">
<ul class="org-ul">
<li>plt.bar</li>
<li>plt.scatter</li>
<li>plt.plot: line plot</li>
<li>plt.hist</li>
<li>plt.pie</li>
</ul>

<div class="org-src-container">
<pre class="src src-python">plt.plot([1,2,3,4])
</pre>
</div>

<p>
Image via <code>plt.imshow()</code>:
</p>
<div class="org-src-container">
<pre class="src src-python">
<span class="org-comment-delimiter"># </span><span class="org-comment">plot a mnist digit</span>
(x_train, y_train), (x_test, y_test) = tf.keras.datasets.mnist.load_data()
<span class="org-comment-delimiter"># </span><span class="org-comment">since the data is just an array (28,28), imshow must have converted</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">it to image pixel properly</span>
plt.imshow(x_train[7777], cmap=<span class="org-string">'Greys'</span>)
<span class="org-comment-delimiter"># </span><span class="org-comment">must call plt.show() to open the figure window. Or, execute</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">%matplotlib in the REPL, you can get the image directly after</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">imshow().</span>
plt.show()

</pre>
</div>
</div>
</div>

<div id="outline-container-org330da02" class="outline-4">
<h4 id="org330da02"><span class="section-number-4">5.10.2</span> <span class="todo TODO">TODO</span> plot options</h4>
</div>

<div id="outline-container-orgc617e06" class="outline-4">
<h4 id="orgc617e06"><span class="section-number-4">5.10.3</span> legends, axis, more settings</h4>
<div class="outline-text-4" id="text-5-10-3">
<p>
Texts:
</p>
<ul class="org-ul">
<li>plt.xlabel()</li>
<li>plt.ylabel()</li>
<li>plt.title()</li>
<li>plt.axis()</li>
<li>plt.text()</li>
<li>plt.annotate</li>
<li>plt.grid(True)</li>
<li>plt.table(): attach a table to an axis!</li>
</ul>

<p>
Scale:
</p>
<ul class="org-ul">
<li>plt.xscale('linear')</li>
<li>plt.yscale('log')</li>
</ul>
</div>
</div>

<div id="outline-container-orgf1a5a45" class="outline-4">
<h4 id="orgf1a5a45"><span class="section-number-4">5.10.4</span> Subplots</h4>
<div class="outline-text-4" id="text-5-10-4">
<div class="org-src-container">
<pre class="src src-python">plt.ioff()
<span class="org-variable-name">figure</span> = plt.figure()
figure.canvas.set_window_title(<span class="org-string">'My Grid Visualization'</span>)
<span class="org-keyword">for</span> x <span class="org-keyword">in</span> <span class="org-builtin">range</span>(height):
<span class="org-highlight-indentation"> </span>   <span class="org-keyword">for</span> y <span class="org-keyword">in</span> <span class="org-builtin">range</span>(width):
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   <span class="org-comment-delimiter"># </span><span class="org-comment">print(x,y)</span>
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   figure.add_subplot(height, width, x*width + y + 1)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   plt.axis(<span class="org-string">'off'</span>)
<span class="org-highlight-indentation"> </span>   <span class="org-highlight-indentation"> </span>   plt.imshow(convert_image_255(images[x*width+y]), cmap=<span class="org-string">'gray'</span>)
<span class="org-comment-delimiter"># </span><span class="org-comment">plt.show()</span>
plt.savefig(filename)
</pre>
</div>

<p>
Or better, create figure and axis, and plot for each axis:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> matplotlib.pyplot <span class="org-keyword">as</span> plt
<span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np

np.random.seed(19680801)
<span class="org-variable-name">data</span> = np.random.randn(2, 100)

<span class="org-variable-name">fig</span>, <span class="org-variable-name">axs</span> = plt.subplots(2, 2, figsize=(5, 5))
axs[0, 0].hist(data[0])
axs[1, 0].scatter(data[0], data[1])
axs[0, 1].plot(data[0], data[1])
axs[1, 1].hist2d(data[0], data[1])

plt.show()
</pre>
</div>
</div>
</div>



<div id="outline-container-orgc1dca5f" class="outline-4">
<h4 id="orgc1dca5f"><span class="section-number-4">5.10.5</span> export to files</h4>
<div class="outline-text-4" id="text-5-10-5">
<p>
Visualize using OS GUI toolkit:
</p>
<div class="org-src-container">
<pre class="src src-python">plt.show()
</pre>
</div>

<p>
Plot to a file:
</p>
<div class="org-src-container">
<pre class="src src-python">pylab.ioff()
plot([1, 2, 3])
savefig(<span class="org-string">"/tmp/test.png"</span>)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org6746aae" class="outline-3">
<h3 id="org6746aae"><span class="section-number-3">5.11</span> imsave</h3>
<div class="outline-text-3" id="text-5-11">
<p>
<code>imsave</code> is deprecated, change from
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> scipy.misc <span class="org-keyword">import</span> imsave
</pre>
</div>

<p>
to
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> imageio <span class="org-keyword">import</span> imwrite <span class="org-keyword">as</span> imsave
</pre>
</div>
</div>
</div>


<div id="outline-container-org7e1f6b1" class="outline-3">
<h3 id="org7e1f6b1"><span class="section-number-3">5.12</span> Nvidia GPU setting</h3>
<div class="outline-text-3" id="text-5-12">
<p>
Select visible GPU in a multi-GPU setting:
</p>
<div class="org-src-container">
<pre class="src src-py">os.environ['CUDA_VISIBLE_DEVICES'] = '3'
</pre>
</div>

<p>
CUDA setup
</p>

<ol class="org-ol">
<li>Install Nvidia driver. This can be done using Ubuntu's software
center. But this is the stable version, not newest</li>
<li>Install cuda. To <code>/usr/local/cuda-10.0</code>. I use the "runfile", with
the <code>--override</code> option (otherwise throw gcc version not supported
error).</li>
<li>Install cudnn by copying header files and library files into <code>/usr/local/cuda-10.0</code></li>
<li>Configure</li>
</ol>

<pre class="example">
CUDA_PATH=/usr/local/cuda-10.0
export LD_LIBRARY_PATH="$CUDA_PATH/lib64:$LD_LIBRARY_PATH"
export PATH="$CUDA_PATH/bin:$PATH"
export LD_LIBRARY_PATH="$LD_LIBRARY_PATH:$CUDA_PATH/extras/CUPTI/lib64"
</pre>
</div>
</div>
</div>
</div>
</body>
</html>
