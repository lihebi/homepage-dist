<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Algorithm</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="assets/hebi.css" /><link rel="stylesheet" type="text/css" href="assets/test.css" /><link rel="stylesheet" type="text/css" href="../assets/hebi.css" /><link rel="stylesheet" type="text/css" href="../assets/test.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Algorithm</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgc323da5">1. Other</a>
<ul>
<li><a href="#org9377c8b">1.1. Barrel shifter</a>
<ul>
<li><a href="#org4496064">1.1.1. shift register</a></li>
</ul>
</li>
<li><a href="#org3c520b6">1.2. Bloom Filter</a></li>
<li><a href="#orgd92d7af">1.3. Linear congruential generator</a></li>
</ul>
</li>
<li><a href="#org340d4ac">2. Dynamic Programming</a>
<ul>
<li><a href="#org72bd7a5">2.1. One dimension</a>
<ul>
<li><a href="#org8db2d49">2.1.1. Define sub-problems</a></li>
<li><a href="#orgb035e74">2.1.2. Recurrence formula</a></li>
</ul>
</li>
<li><a href="#org23f5a1b">2.2. Two Dimensions</a>
<ul>
<li><a href="#org52734c9">2.2.1. Define sub-problems</a></li>
<li><a href="#org29e8325">2.2.2. Recurrence formula</a></li>
</ul>
</li>
<li><a href="#org09e62de">2.3. Interval DP</a>
<ul>
<li><a href="#org46f9ea2">2.3.1. Define sub-problem</a></li>
<li><a href="#org5295bd5">2.3.2. Recurrence formula</a></li>
</ul>
</li>
<li><a href="#orgfb99391">2.4. Tree DP</a>
<ul>
<li><a href="#org9078e55">2.4.1. Define</a></li>
<li><a href="#orgbcf8754">2.4.2. Recurrence</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org10f2ec1">3. String Algorithm</a>
<ul>
<li><a href="#orge798a64">3.1. Knuth–Morris–Pratt(KMP)</a>
<ul>
<li><a href="#org0c162e8">3.1.1. 214. Shortest Palindrome</a>
<ul>
<li><a href="#org75ce2a3">3.1.1.1. KMP</a></li>
<li><a href="#org054f7b1">3.1.1.2. brute force</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgfac209c">3.2. Boyer Moore</a>
<ul>
<li><a href="#orgfd4ff4a">3.2.1. Bad Character Rule</a></li>
<li><a href="#org096236a">3.2.2. Good Suffix Rule</a></li>
<li><a href="#orgeac42b7">3.2.3. Galil Rule</a></li>
</ul>
</li>
<li><a href="#orgf5555ba">3.3. Rabin-Karp Algorithm</a>
<ul>
<li><a href="#org5ce82cc">3.3.1. Rolling Hash</a>
<ul>
<li><a href="#org3b227d0">3.3.1.1. Rabin-Karp rolling hash</a></li>
<li><a href="#org97db302">3.3.1.2. Cyclic Polynomial (Buzhash)</a></li>
</ul>
</li>
<li><a href="#org723b313">3.3.2. Tabulation hashing</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgc323da5" class="outline-2">
<h2 id="orgc323da5"><span class="section-number-2">1</span> Other</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org9377c8b" class="outline-3">
<h3 id="org9377c8b"><span class="section-number-3">1.1</span> Barrel shifter</h3>
<div class="outline-text-3" id="text-1-1">
<p>
A barrel shifter is a digital circuit that can shift a data word
by a specified number of bits in one clock cycle.
</p>


<div class="figure">
<p><img src="https://farm8.staticflickr.com/7578/16260221182_53a096f18c_o.png" alt="16260221182_53a096f18c_o.png" />
</p>
</div>

<p>
In the above image, x is input and y is output.
</p>

<p>
For shift 1, all the erjiguan on the green line exist, while others
not.
</p>
</div>

<div id="outline-container-org4496064" class="outline-4">
<h4 id="org4496064"><span class="section-number-4">1.1.1</span> shift register</h4>
<div class="outline-text-4" id="text-1-1-1">

<div class="figure">
<p><img src="https://farm9.staticflickr.com/8671/16074934899_03921f148b_o.png" alt="16074934899_03921f148b_o.png" />
</p>
</div>

<p>
F0、F1、F2、F3是四个边沿触发的D触发器，每个触发器的输出端Q接到右边一个
触发器的输入端D。因为从时钟信号CP的上升沿加到触发器上开始到输出端新状
态稳定地建立起来有一段延迟时间，所以当时钟信号同时加到四个触发器上时，
每个触发器接收的都是左边一个触发器中原来的数据(F0接收的输入数据D1)。寄
存器中的数据依次右移一位。
</p>
</div>
</div>
</div>

<div id="outline-container-org3c520b6" class="outline-3">
<h3 id="org3c520b6"><span class="section-number-3">1.2</span> Bloom Filter</h3>
<div class="outline-text-3" id="text-1-2">
<p>
It is used to judge whether an item is in a set or not.
</p>

<p>
If bloom() return false, it is false. But if bloom() return true,
it may not be true.
</p>

<p>
The basic idea is, hash(item), map it in a vector of m size.
The vector is 0 initially.
v[hash(item)] is set to 1.
To reduce fault rate, use k hash functions.
</p>

<p>
To verify, only if all k hash functions has 1 in the vector will it return true.
Otherwise return false.
</p>
</div>
</div>


<div id="outline-container-orgd92d7af" class="outline-3">
<h3 id="orgd92d7af"><span class="section-number-3">1.3</span> Linear congruential generator</h3>
<div class="outline-text-3" id="text-1-3">
<p>
A linear congruential generator (LCG)
is an algorithm that yields a sequence of pseudo-randomized numbers.
</p>

<p>
pseudorandom number generator algorithms(PRNG).
</p>

<p>
\(X_{n+1} = (aX_n+c) mod m\)
</p>

<p>
X array is the pseudorandom.
</p>

<ul class="org-ul">
<li>\(X_0\): seed</li>
<li><code>m</code>: modulus</li>
<li><code>a</code>: multiplier</li>
<li><code>c</code>: increment</li>
</ul>

<p>
If c = 0,
the generator is often called a multiplicative congruential generator (MCG),
or Lehmer RNG.
If c ≠ 0, the method is called a mixed congruential generator.
</p>
</div>
</div>
</div>



<div id="outline-container-org340d4ac" class="outline-2">
<h2 id="org340d4ac"><span class="section-number-2">2</span> Dynamic Programming</h2>
<div class="outline-text-2" id="text-2">
<p>
Solve problem by breaking down into simpler sub-problems.
</p>
</div>

<div id="outline-container-org72bd7a5" class="outline-3">
<h3 id="org72bd7a5"><span class="section-number-3">2.1</span> One dimension</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Given n, find the number of different ways to write n as the sum of 1,3,4
</p>
</div>

<div id="outline-container-org8db2d49" class="outline-4">
<h4 id="org8db2d49"><span class="section-number-4">2.1.1</span> Define sub-problems</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
D<sub>n</sub> is the number of ways to write n as sum of 1,3,4
</p>
</div>
</div>

<div id="outline-container-orgb035e74" class="outline-4">
<h4 id="orgb035e74"><span class="section-number-4">2.1.2</span> Recurrence formula</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
D<sub>n</sub> = D<sub>n-1</sub> + D<sub>n-3</sub> + D<sub>n-4</sub>
</p>
</div>
</div>
</div>

<div id="outline-container-org23f5a1b" class="outline-3">
<h3 id="org23f5a1b"><span class="section-number-3">2.2</span> Two Dimensions</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Given two string x and y, find the length of longest common sub-sequence.
</p>
</div>

<div id="outline-container-org52734c9" class="outline-4">
<h4 id="org52734c9"><span class="section-number-4">2.2.1</span> Define sub-problems</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
D<sub>ij</sub> is the length for x<sub>i..i</sub> and y<sub>1..j</sub>
</p>
</div>
</div>

<div id="outline-container-org29e8325" class="outline-4">
<h4 id="org29e8325"><span class="section-number-4">2.2.2</span> Recurrence formula</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
D<sub>ij</sub> =
</p>
<ul class="org-ul">
<li>if x<sub>i</sub> = y<sub>i</sub>: D<sub>i-1,j-1</sub> + 1</li>
<li>otherwise: max{D<sub>i-1,j</sub>, D<sub>i,j-1</sub>}</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org09e62de" class="outline-3">
<h3 id="org09e62de"><span class="section-number-3">2.3</span> Interval DP</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Given a string x=x<sub>1..n</sub>,
find the minimum number of characters that need to be inserted to make it a palindrome.
</p>
</div>

<div id="outline-container-org46f9ea2" class="outline-4">
<h4 id="org46f9ea2"><span class="section-number-4">2.3.1</span> Define sub-problem</h4>
<div class="outline-text-4" id="text-2-3-1">
<p>
D<sub>i,j</sub> be the minimum number of characters.
</p>
</div>
</div>

<div id="outline-container-org5295bd5" class="outline-4">
<h4 id="org5295bd5"><span class="section-number-4">2.3.2</span> Recurrence formula</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
say y<sub>1..k</sub> is the palindrome for x<sub>i..j</sub>,
<b>we have either y<sub>1</sub> = x<sub>i</sub> or y<sub>k</sub> = x<sub>j</sub></b>
</p>

<p>
D<sub>ij</sub> =
</p>
<ul class="org-ul">
<li>if x<sub>i</sub> &ne; x<sub>j</sub>: 1 + min{D<sub>i+1,j</sub>, D<sub>i,j-1</sub>}</li>
<li>if x<sub>i</sub> = x<sub>j</sub>: D<sub>i+1,j-1</sub></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgfb99391" class="outline-3">
<h3 id="orgfb99391"><span class="section-number-3">2.4</span> Tree DP</h3>
<div class="outline-text-3" id="text-2-4">
<p>
Given a tree, color nodes black as many as possible without coloring two adjacent nodes.
</p>
</div>

<div id="outline-container-org9078e55" class="outline-4">
<h4 id="org9078e55"><span class="section-number-4">2.4.1</span> Define</h4>
<div class="outline-text-4" id="text-2-4-1">
<ul class="org-ul">
<li>B(r) as the maximum nodes if the (root) node r is colored black.</li>
<li>W(r) as the maximum nodes if the (root) node r is colored white.</li>
</ul>
</div>
</div>

<div id="outline-container-orgbcf8754" class="outline-4">
<h4 id="orgbcf8754"><span class="section-number-4">2.4.2</span> Recurrence</h4>
<div class="outline-text-4" id="text-2-4-2">
<ul class="org-ul">
<li>B(v) = 1 + &sum;<sub>children</sub> W(c)</li>
<li>W(v) = 1 + &sum;<sub>children</sub> max{B(c), W(c)}</li>
</ul>
</div>
</div>
</div>
</div>


<div id="outline-container-org10f2ec1" class="outline-2">
<h2 id="org10f2ec1"><span class="section-number-2">3</span> String Algorithm</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orge798a64" class="outline-3">
<h3 id="orge798a64"><span class="section-number-3">3.1</span> Knuth–Morris–Pratt(KMP)</h3>
<div class="outline-text-3" id="text-3-1">
<blockquote>
<p>
Match a pattern string P inside given long string T.
</p>
</blockquote>

<p>
The idea is, when failure happens, we shift multiple position instead of just 1.
We are able to do that because when the failure happens, we know what have been examined, so we have everything available to make the best choice.
Specifically, we build a look-up table, <b>for the pattern string</b>.
The table has an entry for each index of the string, describing the shift position.
E.g., <code>ABCABDA</code>, the lookup table will be: <code>0000120</code>.
Actually the table refers to what's the substring matched the prefix of the pattern string.
</p>

<p>
The algorithm to build the table:
</p>

<div class="org-src-container">
<pre class="src src-lisp-interaction">  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">build-table</span> (pattern)
    (<span style="color: #a020f0;">cl-loop</span> with pos = 2
             with match = 0
             with size = (length pattern)
             with ret = (make-vector size 0)
             initially do
             <span style="color: #b22222;">;; </span><span style="color: #b22222;">here I assume size is at least 2</span>
             (<span style="color: #a020f0;">assert</span> (&gt; size 1))
             (aset ret 0 -1)
             (aset ret 1 0)
             while (&lt; pos size) do
             (<span style="color: #a020f0;">if</span> (equal (elt pattern (- pos 1)) (elt pattern match))
                 (<span style="color: #a020f0;">progn</span>
                   (aset ret pos (+ 1 match))
                   (<span style="color: #a020f0;">incf</span> match)
                   (<span style="color: #a020f0;">incf</span> pos))
               (<span style="color: #a020f0;">if</span> (&gt; match 0)
                   (<span style="color: #a020f0;">setq</span> match (elt ret match))
                 (aset ret pos 0)
                 (<span style="color: #a020f0;">incf</span> pos)))
             finally return ret))

  (<span style="color: #a020f0;">ert-deftest</span> <span style="color: #0000ff;">build-table-test</span>()
    (should (equal (build-table <span style="color: #8b2252;">"AABAAAC"</span>) [-1 0 1 0 1 2 2]))
    (should (equal (build-table <span style="color: #8b2252;">"ABCABCD"</span>) [-1 0 0 0 1 2 3])))

  (ert-run-test (ert-get-test 'build-table-test))
</pre>
</div>
</div>

<div id="outline-container-org0c162e8" class="outline-4">
<h4 id="org0c162e8"><span class="section-number-4">3.1.1</span> 214. Shortest Palindrome</h4>
<div class="outline-text-4" id="text-3-1-1">
<blockquote>
<p>
Given a string S, you are allowed to convert it to a palindrome by adding characters in front of it. Find and return the shortest palindrome you can find by performing this transformation.
</p>
</blockquote>
</div>

<div id="outline-container-org75ce2a3" class="outline-5">
<h5 id="org75ce2a3"><span class="section-number-5">3.1.1.1</span> KMP</h5>
<div class="outline-text-5" id="text-3-1-1-1">
<p>
It is easy to convert the problem to find the longest Palindrome at the beginning of s.
To apply KMP, we write the string as <code>s + '#' + reverse(s)</code>.
Then we build the KMP table for this string.
What we need is to find the largest number inside KMP table.
</p>
</div>
</div>

<div id="outline-container-org054f7b1" class="outline-5">
<h5 id="org054f7b1"><span class="section-number-5">3.1.1.2</span> brute force</h5>
<div class="outline-text-5" id="text-3-1-1-2">
<p>
I have a brute-force that "just" pass the tests.
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #a020f0;">class</span> <span style="color: #228b22;">Solution</span> {
<span style="color: #a020f0;">public</span>:
  <span style="color: #228b22;">string</span> <span style="color: #0000ff;">shortestPalindrome</span>(<span style="color: #228b22;">string</span> <span style="color: #a0522d;">s</span>) {
    <span style="color: #a020f0;">if</span> (s.size() == 0) <span style="color: #a020f0;">return</span> s;
    <span style="color: #a020f0;">if</span> (s.size() == 1) <span style="color: #a020f0;">return</span> s;
    <span style="color: #a020f0;">for</span> (<span style="color: #228b22;">int</span> <span style="color: #a0522d;">i</span>=(s.size()-1)/2;i&gt;0;i--) {
      <span style="color: #a020f0;">if</span> (check(s, i, <span style="color: #008b8b;">false</span>)) {
        <span style="color: #b22222;">// </span><span style="color: #b22222;">std::cout &lt;&lt; "success on " &lt;&lt; i &lt;&lt; " false"  &lt;&lt; "\n";</span>
        <span style="color: #228b22;">string</span> <span style="color: #a0522d;">sub</span> = s.substr(<span style="color: #228b22;">i</span>*2+2);
        <span style="color: #008b8b;">std</span>::reverse(sub.begin(), sub.end());
        <span style="color: #a020f0;">return</span> sub + s;
      } <span style="color: #a020f0;">else</span> <span style="color: #a020f0;">if</span> (check(s, <span style="color: #228b22;">i</span>, <span style="color: #008b8b;">true</span>)) {
        <span style="color: #b22222;">// </span><span style="color: #b22222;">std::cout &lt;&lt; "success on " &lt;&lt; i &lt;&lt; " true"  &lt;&lt; "\n";</span>
        <span style="color: #b22222;">// </span><span style="color: #b22222;">THREE</span>
        <span style="color: #b22222;">// </span><span style="color: #b22222;">1 2 3 4 5 6</span>
        <span style="color: #b22222;">// </span><span style="color: #b22222;">- - -|- - -</span>
        <span style="color: #b22222;">// </span><span style="color: #b22222;">6/2=3</span>
        <span style="color: #b22222;">// </span><span style="color: #b22222;">1 2 3 4 5</span>
        <span style="color: #b22222;">// </span><span style="color: #b22222;">- - | - -</span>
        <span style="color: #b22222;">// </span><span style="color: #b22222;">i*2+1 - end</span>
        <span style="color: #228b22;">string</span> <span style="color: #a0522d;">sub</span> = s.substr(<span style="color: #228b22;">i</span>*2+1);
        <span style="color: #008b8b;">std</span>::reverse(sub.begin(), sub.end());
        <span style="color: #a020f0;">return</span> sub + s;
      }
    }
    <span style="color: #228b22;">string</span> <span style="color: #a0522d;">sub</span>;
    <span style="color: #a020f0;">if</span> (check(s, 0, <span style="color: #008b8b;">false</span>)) {
      sub = s.substr(2);
    } <span style="color: #a020f0;">else</span> {
      sub = s.substr(1);
    }
    <span style="color: #008b8b;">std</span>::reverse(sub.begin(), sub.end());
    <span style="color: #a020f0;">return</span> sub + s;
  }
  <span style="color: #b22222;">/**</span>
<span style="color: #b22222;">   * on: pivot on idx or not</span>
<span style="color: #b22222;">   */</span>
  <span style="color: #228b22;">bool</span> <span style="color: #0000ff;">check</span>(<span style="color: #228b22;">string</span> &amp;<span style="color: #a0522d;">s</span>, <span style="color: #228b22;">int</span> <span style="color: #a0522d;">idx</span>, <span style="color: #228b22;">bool</span> <span style="color: #a0522d;">on</span>) {
    <span style="color: #b22222;">// </span><span style="color: #b22222;">std::cout &lt;&lt; idx  &lt;&lt; "\n";</span>
    <span style="color: #a020f0;">if</span> (idx &lt;0 || idx &gt;= (<span style="color: #228b22;">int</span>)s.size()) <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">false</span>;
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">i</span>=0,<span style="color: #a0522d;">j</span>=0;
    <span style="color: #a020f0;">if</span> (on) {
      i=idx-1;
      j=idx+1;
    } <span style="color: #a020f0;">else</span> {
      i = idx;
      j = idx+1;
    }
    <span style="color: #228b22;">int</span> <span style="color: #a0522d;">size</span> = s.size();
    <span style="color: #a020f0;">while</span> (i &gt;= 0) {
      <span style="color: #a020f0;">if</span> (j &gt;= size) <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">false</span>;
      <span style="color: #a020f0;">if</span> (s[i] != s[j]) <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">false</span>;
      i--;
      j++;
    }
    <span style="color: #a020f0;">return</span> <span style="color: #008b8b;">true</span>;
  }
};
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgfac209c" class="outline-3">
<h3 id="orgfac209c"><span class="section-number-3">3.2</span> Boyer Moore</h3>
<div class="outline-text-3" id="text-3-2">
<p>
It is a string match algorithm.
</p>

<p>
The rule lookup is in a hash table,
which can be formed during proprocessing of pattern.
</p>

<p>
In the following examples, the lower case denote the matched or unmatched part for illustration purpose only.
They are upper case when considering matching.
</p>
</div>
<div id="outline-container-orgfd4ff4a" class="outline-4">
<h4 id="orgfd4ff4a"><span class="section-number-4">3.2.1</span> Bad Character Rule</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
Match from last. In the below example, the suffix <code>MAN</code> matches, but <code>N</code> does not match. Shift the pattern so that the first N (counted from last) go to the <code>N</code> place.
</p>

<div class="org-src-container">
<pre class="src src-text">- - - - X - - K - - -
A N P A n M A N A M -
- N n A A M A N - - -
- - - N n A A M A N -
</pre>
</div>

<p>
from right end to left.
when a mismatch happens at `n`,
find to left a `n`, then shift it to the position.
</p>
</div>
</div>

<div id="outline-container-org096236a" class="outline-4">
<h4 id="org096236a"><span class="section-number-4">3.2.2</span> Good Suffix Rule</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
Similar to the bad rule, find the matched, in this case <code>NAM</code>.
Then, if an failure happens, move the same part to the left of that match (in this case another <code>NAM</code> at the left) to that position.
</p>
<div class="org-src-container">
<pre class="src src-text">- - - - X - - K - - - - -
M A N P A n a m A N A P -
A n a m P n a m - - - - -
- - - - A n a m P N A M -
</pre>
</div>

<p>
when a mismatch happens,
<code>nam</code> is the longest good suffix.
Find <code>nam</code> to the left,
and shift it to the position.
</p>
</div>
</div>

<div id="outline-container-orgeac42b7" class="outline-4">
<h4 id="orgeac42b7"><span class="section-number-4">3.2.3</span> Galil Rule</h4>
<div class="outline-text-4" id="text-3-2-3">
<p>
As opposed to shifting, the Galil rule deals with speeding up the actual comparisons done at each alignment by skipping sections that are known to match.
Suppose that at an alignment k1,
P is compared with T down to character c of T.
Then if P is shifted to k2 such that its left end is between c and k1,
in the next comparison phase a prefix of P must match the substring T[(k2 - n)..k1].
Thus if the comparisons get down to position k1 of T,
an occurrence of P can be recorded without explicitly comparing past k1.
In addition to increasing the efficiency of Boyer-Moore,
the Galil rule is required for proving linear-time execution in the worst case.
</p>
</div>
</div>
</div>

<div id="outline-container-orgf5555ba" class="outline-3">
<h3 id="orgf5555ba"><span class="section-number-3">3.3</span> Rabin-Karp Algorithm</h3>
<div class="outline-text-3" id="text-3-3">
<p>
It is a string searching algorithm.
</p>

<p>
The Naive Solution for string search:
</p>

<div class="org-src-container">
<pre class="src src-C"><span style="color: #228b22;">int</span> <span style="color: #0000ff;">func</span>(<span style="color: #228b22;">char</span> <span style="color: #a0522d;">s</span>[], <span style="color: #228b22;">int</span> <span style="color: #a0522d;">n</span>, <span style="color: #228b22;">char</span> <span style="color: #a0522d;">pattern</span>[], <span style="color: #228b22;">int</span> <span style="color: #a0522d;">m</span>) {
  <span style="color: #228b22;">char</span> *<span style="color: #a0522d;">ps</span>,*<span style="color: #a0522d;">pp</span>; <span style="color: #b22222;">//</span><span style="color: #b22222;">*</span>
  ps=s;
  pp=pattern;
  <span style="color: #a020f0;">for</span> (i=0;i&lt;n-m+1;) {
    <span style="color: #a020f0;">if</span> (*pp==<span style="color: #8b2252;">'\0'</span>) <span style="color: #a020f0;">return</span> i; <span style="color: #b22222;">//</span><span style="color: #b22222;">*</span>
    <span style="color: #a020f0;">if</span> (*ps == *pp) { <span style="color: #b22222;">//</span><span style="color: #b22222;">*</span>
      ps++;pp++;
    } <span style="color: #a020f0;">else</span> {
      i++;
      ps=s+i;
      pp=pattern;
    }
  }
}
</pre>
</div>

<p>
The running time is \(O(mn)\).
</p>

<p>
The Rabin-Karp algorithm use hash for pattern match.
First calculate <code>hash(pattern)</code>.
Then for every s[i,i+m-1], calculate the hash.
Then compare them.
</p>

<p>
The key of the algorithm is the hash function.
If the hash function need time m to compute, then it is still \(O(mn)\).
If the collision happens often, then even if hash matches, we still need to verify.
</p>

<p>
Key point is to select a hast function, such that <code>hash(i,i+m-1)</code> can be computed
by <code>hash(i-1,i+m-2)</code>.
</p>

<p>
If add all characters' ASCII together, collision is often.
</p>

<p>
The used hash function is:
select a large prime as base, 101 for example.
Hash value is:
</p>

\begin{equation}
hash("abc") = ASCII('a')*101^2 + ASCII('b')*101^1 + ASCII('c')*101^0
\end{equation}

<p>
Rabin-Karp is not so good for single string match because the worst case is \(O(mn)\),
but it is the algorithm of choice for multiple pattern search.
</p>

<p>
K patterns, in a large string s, find any one of the K patterns.
</p>
</div>

<div id="outline-container-org5ce82cc" class="outline-4">
<h4 id="org5ce82cc"><span class="section-number-4">3.3.1</span> Rolling Hash</h4>
<div class="outline-text-4" id="text-3-3-1">
</div>
<div id="outline-container-org3b227d0" class="outline-5">
<h5 id="org3b227d0"><span class="section-number-5">3.3.1.1</span> Rabin-Karp rolling hash</h5>
</div>

<div id="outline-container-org97db302" class="outline-5">
<h5 id="org97db302"><span class="section-number-5">3.3.1.2</span> Cyclic Polynomial (Buzhash)</h5>
<div class="outline-text-5" id="text-3-3-1-2">
<p>
<code>s(a)</code> means shift a left.
</p>

\begin{equation}
H=s^{k-1}(h(c_1)) \oplus s^{k-2}(h(c_2)) \oplus \ldots \oplus s(h(c_{k-1})) \oplus h(c_k)
\end{equation}

<p>
<code>h</code> is a tabulation hashing.
</p>

<p>
To remove \(c_1\) and add \(c_{k+1}\):
</p>

\begin{equation}
H = s(H) \oplus s^k(h(c_1)) \oplus h(c_{k+1})
\end{equation}
</div>
</div>
</div>

<div id="outline-container-org723b313" class="outline-4">
<h4 id="org723b313"><span class="section-number-4">3.3.2</span> Tabulation hashing</h4>
<div class="outline-text-4" id="text-3-3-2">
<p>
input key is <code>p</code> bits, output is <code>q</code> bits.
choose a <code>r</code> less then <code>p</code>, and \(t=\lceil p/r \rceil\).
</p>

<p>
view a key as t r-bit numbers. Use a lookup table filled with random values
to compute hash value for each of t numbers. Xor them together.
</p>

<p>
The choice of r should be made in such a way that this table is not too large,
so that it fits into the computer's cache memory.
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="validation"></p>
</div>
</body>
</html>
